"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33443],{33443:(e,t,n)=>{n.r(t),n.d(t,{BlockDraggable:()=>j});var l=n(99019),o=n(5147),i=n(15457),r=n(54568),a=n(99680),c=n(7620),s=n(57721),d=n(58289),p=n(30589),u=n(97170),m=n(48674),h=n(13600),f=n(50357),g=n(41816),v=n(28268),b=n(92405),y=n(93955),x=n(92972),N=n(87536);let w=[m.t.column,m.t.tr,m.t.td],j=e=>{let{editor:t,element:n,path:o}=e;if(c.useMemo(()=>!t.dom.readOnly&&(!!(1===o.length&&!(0,h.Xj)(t,n,w)||3===o.length&&!(0,h.Xj)(t,n,w)&&t.api.some({at:o,match:{type:t.getType(m.t.column)}})||4===o.length&&!(0,h.Xj)(t,n,w)&&t.api.some({at:o,match:{type:t.getType(m.t.table)}}))||!1),[t,n,o]))return e=>(0,r.jsx)(k,(0,l._)({},e))};function k(e){var t;let{children:n,editor:l,element:o,path:i}=e,a=l.getApi(p.vO).blockSelection,{isAboutToDrag:d,isDragging:u,nodeRef:m,previewRef:h,handleRef:v}=(0,s.PM)({element:o,onDropHandler:(e,t)=>{let{dragItem:n}=t,l=n.id;a&&a.add(l),k()}}),b=3===i.length,x=4===i.length,[w,j]=c.useState(0),k=()=>{if(h.current){var e;h.current.replaceChildren(),null==(e=h.current)||e.classList.add("hidden")}};c.useEffect(()=>{u||k()},[u]),c.useEffect(()=>{if(d){var e;null==(e=h.current)||e.classList.remove("opacity-0")}},[d]);let[E,S]=c.useState(0);return(0,r.jsxs)("div",{className:(0,N.cn)("relative",u&&"opacity-50",(null==(t=(0,f.zt)(l,o.type))?void 0:t.node.isContainer)?"group/container":"group"),onMouseEnter:()=>{u||S(M(l,o))},children:[!x&&(0,r.jsx)(C,{children:(0,r.jsx)("div",{className:(0,N.cn)("slate-blockToolbarWrapper","flex h-[1.5em]",b&&"h-4"),children:(0,r.jsx)("div",{className:(0,N.cn)("slate-blockToolbar relative w-4.5","pointer-events-auto mr-1 flex items-center",b&&"mr-1.5"),children:(0,r.jsx)(y.$,{ref:v,variant:"ghost",className:"-left-0 absolute h-6 w-full p-0",style:{top:"".concat(E+3,"px")},"data-plate-prevent-deselect":!0,children:(0,r.jsx)(O,{isDragging:u,previewRef:h,resetPreview:k,setPreviewTop:j})})})})}),(0,r.jsx)("div",{ref:h,className:(0,N.cn)("-left-0 absolute hidden w-full"),style:{top:"".concat(-w,"px")},contentEditable:!1}),(0,r.jsxs)("div",{ref:m,className:"slate-blockWrapper flow-root",onContextMenu:e=>l.getApi(p.vO).blockSelection.addOnContextMenu({element:o,event:e}),children:[(0,r.jsx)(g.wu,{children:n}),(0,r.jsx)(_,{})]})]})}function C(e){let t,n,c,s,d,u,m=(0,a.c)(16);m[0]!==e?({children:t,className:n}=e,c=(0,i._)(e,["children","className"]),m[0]=e,m[1]=t,m[2]=n,m[3]=c):(t=m[1],n=m[2],c=m[3]);let h=(0,v.Q_)(),g=(0,v.iQ)(),y=(0,v.gO)(p.vO,"isSelectionAreaVisible"),x=(0,b.f7)();if(m[4]!==h||m[5]!==g.type){var w;s=(null==(w=(0,f.zt)(h,g.type))?void 0:w.node.isContainer)?"group-hover/container:opacity-100":"group-hover:opacity-100",m[4]=h,m[5]=g.type,m[6]=s}else s=m[6];let j=y&&"hidden",k=!x&&"opacity-0";return m[7]!==n||m[8]!==s||m[9]!==j||m[10]!==k?(d=(0,N.cn)("slate-gutterLeft","-translate-x-full absolute top-0 z-50 flex h-full cursor-text hover:opacity-100 sm:opacity-0",s,j,k,n),m[7]=n,m[8]=s,m[9]=j,m[10]=k,m[11]=d):d=m[11],m[12]!==t||m[13]!==c||m[14]!==d?(u=(0,r.jsx)("div",(0,o._)((0,l._)({},c),{className:d,contentEditable:!1,children:t})),m[12]=t,m[13]=c,m[14]=d,m[15]=u):u=m[15],u}let O=c.memo(function(e){let t,n,l,o,i,c,m,h,f=(0,a.c)(23),{isDragging:g,previewRef:b,resetPreview:y,setPreviewTop:N}=e,w=(0,v.Q_)(),j=(0,v.iQ)();return f[0]!==w?(t=e=>{e.preventDefault(),w.getApi(p.vO).blockSelection.focus()},f[0]=w,f[1]=t):t=f[1],f[2]!==w||f[3]!==j||f[4]!==b||f[5]!==y?(n=e=>{var t,n,l;if(y(),0!==e.button&&2!==e.button||e.shiftKey)return;let o=w.getApi(p.vO).blockSelection.getNodes({sort:!0}),i=o.length>0?o:w.api.blocks({mode:"highest"});i.some(e=>{let[t]=e;return t.id===j.id})||(i=[[j,w.api.findPath(j)]]);let r=(0,d.k)(w,i).map(D);0===o.length&&(w.tf.blur(),w.tf.collapse());let a=E(w,r);null==(t=b.current)||t.append(...a),null==(n=b.current)||n.classList.remove("hidden"),null==(l=b.current)||l.classList.add("opacity-0"),w.setOption(s.qp,"multiplePreviewRef",b),w.getApi(p.vO).blockSelection.set(r.map(A))},f[2]=w,f[3]=j,f[4]=b,f[5]=y,f[6]=n):n=f[6],f[7]!==w||f[8]!==j||f[9]!==g||f[10]!==N?(l=()=>{if(g)return;let e=w.getApi(p.vO).blockSelection.getNodes({sort:!0}),t=e.length>0?e:w.api.blocks({mode:"highest"});t.some(e=>{let[t]=e;return t.id===j.id})||(t=[[j,w.api.findPath(j)]]);let n=(0,d.k)(w,t),l=n.map(T);l.length>1&&l.includes(j.id)?N(S(w,{blocks:n.map(R),element:j})):N(0)},f[7]=w,f[8]=j,f[9]=g,f[10]=N,f[11]=l):l=f[11],f[12]!==y?(o=()=>{y()},f[12]=y,f[13]=o):o=f[13],f[14]===Symbol.for("react.memo_cache_sentinel")?(i=(0,r.jsx)(u.A,{className:"text-muted-foreground"}),f[14]=i):i=f[14],f[15]!==t||f[16]!==n||f[17]!==l||f[18]!==o?(c=(0,r.jsx)(x.k$,{asChild:!0,children:(0,r.jsx)("div",{className:"flex size-full items-center justify-center",onClick:t,onMouseDown:n,onMouseEnter:l,onMouseUp:o,"data-plate-prevent-deselect":!0,role:"button",children:i})}),f[15]=t,f[16]=n,f[17]=l,f[18]=o,f[19]=c):c=f[19],f[20]===Symbol.for("react.memo_cache_sentinel")?(m=(0,r.jsx)(x.ZI,{children:"Drag to move"}),f[20]=m):m=f[20],f[21]!==c?(h=(0,r.jsxs)(x.m_,{children:[c,m]}),f[21]=c,f[22]=h):h=f[22],h}),_=c.memo(function(e){let t,n,c,d,p=(0,a.c)(10);p[0]!==e?({className:t}=e,n=(0,i._)(e,["className"]),p[0]=e,p[1]=t,p[2]=n):(t=p[1],n=p[2]);let{dropLine:u}=(0,s.P8)();if(!u)return null;let m="top"===u&&"-top-px",h="bottom"===u&&"-bottom-px";return p[3]!==t||p[4]!==m||p[5]!==h?(c=(0,N.cn)("slate-dropLine","absolute inset-x-0 h-0.5 opacity-100 transition-opacity","bg-brand/50",m,h,t),p[3]=t,p[4]=m,p[5]=h,p[6]=c):c=p[6],p[7]!==n||p[8]!==c?(d=(0,r.jsx)("div",(0,o._)((0,l._)({},n),{className:c})),p[7]=n,p[8]=c,p[9]=d):d=p[9],d}),E=(e,t)=>{let n=[],l=[],o=e=>{Array.from(e.attributes).forEach(t=>{(t.name.startsWith("data-slate")||t.name.startsWith("data-block-id"))&&e.removeAttribute(t.name)}),Array.from(e.children).forEach(e=>{o(e)})};return t.forEach((i,r)=>{((i,r)=>{let a=e.api.toDOMNode(i),c=a.cloneNode(!0),s=a.scrollLeft;if(s>0){let e=document.createElement("div");e.style.overflow="hidden",e.style.width="".concat(a.clientWidth,"px");let t=document.createElement("div");for(t.style.transform="translateX(-".concat(s,"px)"),t.style.width="".concat(a.scrollWidth,"px");c.firstChild;)t.append(c.firstChild);let n=window.getComputedStyle(a);c.style.padding="0",t.style.padding=n.padding,e.append(t),c.append(e)}l.push(i.id);let d=document.createElement("div");d.append(c),d.style.display="flow-root";let p=t[r-1];if(p){let t=e.api.toDOMNode(p).parentElement.getBoundingClientRect(),n=a.parentElement.getBoundingClientRect().top-t.bottom;n>15&&(d.style.marginTop="".concat(n,"px"))}o(c),n.push(d)})(i,r)}),e.setOption(s.qp,"draggingId",l),n},S=(e,t)=>{let{blocks:n,element:l}=t,o=e.api.toDOMNode(l),i=e.api.toDOMNode(e),r=n[0],a=e.api.toDOMNode(r),c=Number(window.getComputedStyle(i).paddingTop.replace("px","")),s=a.getBoundingClientRect().top-i.getBoundingClientRect().top-c,d=Number(window.getComputedStyle(a).marginTop.replace("px",""));return o.getBoundingClientRect().top-i.getBoundingClientRect().top-c-s+d-Number(window.getComputedStyle(o).marginTop.replace("px",""))},M=(e,t)=>{let n=e.api.toDOMNode(t);return Number(window.getComputedStyle(n).marginTop.replace("px",""))};function D(e){let[t]=e;return t}function A(e){return e.id}function T(e){return e[0].id}function R(e){return e[0]}}}]);