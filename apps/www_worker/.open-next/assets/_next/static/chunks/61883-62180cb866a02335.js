"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61883],{61883:(e,t,l)=>{l.d(t,{B:()=>I,Q:()=>E,V:()=>R,Y:()=>k,Z:()=>_,_:()=>ee,a:()=>er,dt:()=>m,g:()=>et,i:()=>en,j:()=>L,lt:()=>g,n:()=>ei,nt:()=>C,ot:()=>w,r:()=>ea,rt:()=>N,st:()=>y,t:()=>eo,tt:()=>S,ut:()=>b,v:()=>X,x:()=>J,y:()=>Y});var r=l(99019),a=l(5147),i=l(15457),n=l(48674),o=l(14796),s=l(50357),c=l(13988),f=l(2498),u=l(91579);let d=function(e){let{children:t,header:l,row:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l=null!=l?l:!!r&&r.children.every(t=>t.type===e.getType(n.t.th)),{children:null!=t?t:[e.api.create.block()],type:l?e.getType(n.t.th):e.getType(n.t.td)}},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,[l={}]=[t],{colCount:r=1}=l,a=(0,i._)(l,["colCount"]),{api:o}=e.getPlugin({key:n.t.table});return{children:Array.from({length:r}).fill(r).map(()=>o.create.tableCell(a)),type:e.getType(n.t.tr)}},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,[l={}]=[t],{colCount:o,header:s,rowCount:c=0}=l,f=(0,i._)(l,["colCount","header","rowCount"]),{api:u}=e.getPlugin({key:n.t.table});return{children:Array.from({length:c}).fill(c).map((e,t)=>u.create.tableRow((0,a._)((0,r._)({colCount:o},f),{header:s&&0===t}))),type:e.getType(n.t.table)}},m=e=>{var t;return e.colSpan||Number(null==(t=e.attributes)?void 0:t.colspan)||1};function b(e,t){var l,a;let i,{all:o,cellNode:c,tableNode:f}=t,{api:u,getOptions:d,setOption:p}=(0,s.Gt)(e,{key:n.t.table});if(!f&&(!c||!(f=null==(l=e.api.above({at:c,match:{type:e.getType(n.t.table)}}))?void 0:l[0])))return;let{_cellIndices:h}=d(),m=(0,r._)({},h),b=!1,g=[];for(let e=0;e<f.children.length;e++){let t=f.children[e],l=0;for(let r of t.children){for(;null==(a=g[e])?void 0:a[l];)l++;let t={col:l,row:e},n=h[r.id];if(((null==n?void 0:n.col)!==t.col||(null==n?void 0:n.row)!==t.row)&&(b=!0),m[r.id]=t,r.id===(null==c?void 0:c.id)&&(i=t,!o))break;let s=u.table.getColSpan(r),f=u.table.getRowSpan(r);for(let t=0;t<f;t++){g[e+t]=g[e+t]||[];for(let r=0;r<s;r++)g[e+t][l+r]=!0}l+=s}}return b&&p("_cellIndices",m),i}let g=(e,t)=>{let{getOption:l}=(0,s.Gt)(e,{key:n.t.table}),r=l("cellIndices",t.id);return!r&&((r=b(e,{cellNode:t}))||e.api.debug.warn("No cell indices found for element. Make sure all table cells have an id.","TABLE_CELL_INDICES")),null!=r?r:{col:0,row:0}},v=e=>{let t=e.at(-2);if(void 0===t)throw Error("can not get rowIndex of path ".concat(e));return t},y=e=>(0,s.Ut)(e,[n.t.td,n.t.th]),w=function(e){let{at:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t){var l;if(!(t=null==(l=e.api.node({match:{type:y(e)}}))?void 0:l[1]))return}if(!t.at(-1))return;let r=o.s2.previous(t);return e.api.node(r)},N=e=>{var t;return e.rowSpan||Number(null==(t=e.attributes)?void 0:t.rowspan)||1};function C(e,t){let l=1/0,r=-1/0,a=1/0,i=-1/0;for(let n of t){let{col:t,row:o}=g(e,n),s=m(n),c=o+N(n)-1,f=t+s-1;o<l&&(l=o),c>r&&(r=c),t<a&&(a=t),f>i&&(i=f)}return{maxCol:i,maxRow:r,minCol:a,minRow:l}}let S=function(e){let{at:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t){var l;if(!(t=null==(l=e.api.node({match:{type:y(e)}}))?void 0:l[1]))return}let r=t.at(-1),a=t.at(-2);if(0===a)return;let i=[...o.s2.parent(o.s2.parent(t)),a-1,r];return e.api.node(i)},_=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{select:i={none:!0,outer:!0,side:!0}}=l,n=t;if(!n||0===n.length){let t=e.api.block({match:{type:y(e)}});if(!t)return{bottom:!0,left:!0,none:!1,outer:!0,right:!0,top:!0};n=[t[0]]}let o=n.map(e=>e),{maxCol:s,maxRow:c,minCol:f,minRow:u}=C(e,o),d=!1,p=!0,h={bottom:!1,left:!1,right:!1,top:!1};for(let t of o){var b,v,_,E,z,k,T,x,A,P,M,R,I,Z,G,D,O,B,j,q,L,H,K,Q,F,W,$,U,V,J,Y,X,ee,et,el,er;let{col:l,row:r}=g(e,t),a=e.api.findPath(t),n=m(t),o=N(t),y=0===r,C=0===l;if(a){if(i.none&&!d&&(y&&(null!=(b=null==(k=t.borders)||null==(z=k.top)?void 0:z.size)?b:1)>0&&(d=!0),C&&(null!=(v=null==(x=t.borders)||null==(T=x.left)?void 0:T.size)?v:1)>0&&(d=!0),(null!=(_=null==(P=t.borders)||null==(A=P.bottom)?void 0:A.size)?_:1)>0&&(d=!0),(null!=(E=null==(R=t.borders)||null==(M=R.right)?void 0:M.size)?E:1)>0&&(d=!0),!d)){if(!y){let t=S(e,{at:a});t&&(null!=(I=null==(G=t[0].borders)||null==(Z=G.bottom)?void 0:Z.size)?I:1)>0&&(d=!0)}if(!C){let t=w(e,{at:a});t&&(null!=(D=null==(B=t[0].borders)||null==(O=B.right)?void 0:O.size)?D:1)>0&&(d=!0)}}if(i.side||i.outer)for(let d=r;d<r+o;d++)for(let r=l;r<l+n;r++){if(d===u)if(y)(null!=(j=null==(L=t.borders)||null==(q=L.top)?void 0:q.size)?j:1)<1?(h.top=!1,i.outer&&(p=!1)):h.top||(h.top=!0);else{let t=S(e,{at:a});if(t){let[e]=t;(null!=(H=null==(Q=e.borders)||null==(K=Q.bottom)?void 0:K.size)?H:1)<1?(h.top=!1,i.outer&&(p=!1)):h.top||(h.top=!0)}}if(d===c&&((null!=(F=null==($=t.borders)||null==(W=$.bottom)?void 0:W.size)?F:1)<1?(h.bottom=!1,i.outer&&(p=!1)):h.bottom||(h.bottom=!0)),r===f)if(C)(null!=(U=null==(J=t.borders)||null==(V=J.left)?void 0:V.size)?U:1)<1?(h.left=!1,i.outer&&(p=!1)):h.left||(h.left=!0);else{let t=w(e,{at:a});if(t){let[e]=t;(null!=(Y=null==(ee=e.borders)||null==(X=ee.right)?void 0:X.size)?Y:1)<1?(h.left=!1,i.outer&&(p=!1)):h.left||(h.left=!0)}}r===s&&((null!=(et=null==(er=t.borders)||null==(el=er.right)?void 0:el.size)?et:1)<1?(h.right=!1,i.outer&&(p=!1)):h.right||(h.right=!0))}}}return(0,a._)((0,r._)({},i.side?h:{bottom:!0,left:!0,right:!0,top:!0}),{none:!!i.none&&!d,outer:!i.outer||p})};function E(e,t,l){let{maxCol:r,maxRow:a,minCol:i,minRow:n}=C(e,t);return t.every(t=>{let{col:o,row:s}=g(e,t),c=m(t),f=N(t),u=e.api.findPath(t);if(!u)return!0;for(let m=s;m<s+f;m++)for(let f=o;f<o+c;f++){var d,p,h,b,v,y,C,_,E,z,k,T,x,A,P,M,R,I;if("top"===l&&m===n){if(0===s)return(null!=(C=null==(z=t.borders)||null==(E=z.top)?void 0:E.size)?C:1)>=1;let l=S(e,{at:u});if(!l)return!0;let[r]=l;return(null!=(_=null==(T=r.borders)||null==(k=T.bottom)?void 0:k.size)?_:1)>=1}if("bottom"===l&&m===a)return(null!=(d=null==(b=t.borders)||null==(h=b.bottom)?void 0:h.size)?d:1)>=1;if("left"===l&&f===i){if(0===o)return(null!=(x=null==(M=t.borders)||null==(P=M.left)?void 0:P.size)?x:1)>=1;let l=w(e,{at:u});if(!l)return!0;let[r]=l;return(null!=(A=null==(I=r.borders)||null==(R=I.right)?void 0:R.size)?A:1)>=1}if("right"===l&&f===r)return(null!=(p=null==(y=t.borders)||null==(v=y.right)?void 0:v.size)?p:1)>=1}return!0})}let z=(e,t)=>e.api.block((0,r._)({above:!0,match:{type:e.getType(n.t.table)}},t)),k=(e,t)=>{var l,r;let{cellIndices:a,defaultBorder:i={size:1},element:n}=t,o=e.api.findPath(n),[s,c]=null!=(l=e.api.parent(o))?l:[];if(!s||!c)return{bottom:i,right:i};let[f]=e.api.parent(c),{col:u}=null!=a?a:g(e,n),d=(null==(r=f.children)?void 0:r[0])===s,p=e=>{var t,l,r,a;let o=null==(a=n.borders)?void 0:a[e];return{color:null!=(t=null==o?void 0:o.color)?t:i.color,size:null!=(l=null==o?void 0:o.size)?l:i.size,style:null!=(r=null==o?void 0:o.style)?r:i.style}};return{bottom:p("bottom"),left:0===u?p("left"):void 0,right:p("right"),top:d?p("top"):void 0}},T=(e,t)=>{let{cellIndices:l,colSizes:r,element:a,rowSize:i}=t,{api:o}=(0,s.Gt)(e,{key:n.t.table}),c=e.api.findPath(a);if(!i){var f;let[t]=null!=(f=e.api.parent(c))?f:[];if(!t)return{minHeight:0,width:0};i=t.size}if(!r){let[,t]=e.api.parent(c),[l]=e.api.parent(t);r=I(l)}let u=o.table.getColSpan(a),{col:d}=null!=l?l:g(e,a);return{minHeight:i,width:(null!=r?r:[]).slice(d,d+u).reduce((e,t)=>e+(t||0),0)}},x=e=>{var t,l;return(null==(l=e.children)||null==(t=l[0])?void 0:t.children)?e.children[0].children.map(e=>{var t;return e.colSpan||(null==e||null==(t=e.attributes)?void 0:t.colspan)||1}).reduce((e,t)=>Number(e)+Number(t)):0},A=function(e){let{at:t=e.selection}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return;let l=e.api.node({at:t,match:{type:y(e)}});if(!l)return;let[,r]=l,a=e.api.above({at:r,match:{type:e.getType(n.t.tr)}});if(!a)return;let[,i]=a,o=e.api.above({at:i,match:{type:e.getType(n.t.table)}});if(o)return{cell:l,row:a,table:o}},P=(e,t)=>{let{col:l,row:r}=e;return{col:l+m(t)-1,row:r+N(t)-1}},M=(e,t,l,r)=>t.children.flatMap(e=>e.children).find(t=>{let a=g(e,t),{col:i,row:n}=a,{col:o,row:s}=P(a,t);return!!(r>=i)&&!!(r<=o)&&!!(l>=n)&&!!(l<=s)}),R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,[l={}]=[t],{format:a="table"}=l,c=(0,i._)(l,["format"]),{api:f}=e.getPlugin({key:n.t.table}),u=e.api.edgeBlocks((0,r._)({match:{type:y(e)}},c));if(u){let[t,l]=u;if(!o.s2.equals(t[1],l[1]))return((e,t)=>{let{at:l,format:r="table"}=t,{api:a}=e.getPlugin({key:n.t.table}),{disableMerge:i}=e.getOptions(en);if(!i)return((e,t)=>{var l;let{at:r,format:a}=t,{api:i,type:n}=(0,s.Gt)(e,en),o=e.api.node({at:r.anchor.path,match:{type:y(e)}}),c=e.api.node({at:r.focus.path,match:{type:y(e)}}),f=o[0],u=c[0],d=r.anchor.path.slice(0,-2),p=e.api.node({at:d,match:{type:n}})[0],{col:h,row:m}=P(g(e,f),f),{col:b,row:v}=P(g(e,u),u),w=Math.min(m,v),N=Math.max(m,v),C=Math.min(h,b),S=Math.max(h,b),_=N-w,E=S-C,z=i.create.table({children:[],colCount:E+1,rowCount:_+1}),k=[],T=new WeakSet,x=w,A=C;for(;;){let t=M(e,p,x,A);if(!t)break;let l=g(e,t),{col:r,row:a}=P(l,t),{col:n,row:o}=l;if(o<w||a>N||n<C||r>S){T=new WeakSet,k=[],w=Math.min(w,o),N=Math.max(N,a),C=Math.min(C,n),S=Math.max(S,r),x=w,A=C;let e=N-w,t=S-C;z=i.create.table({children:[],colCount:t+1,rowCount:e+1});continue}if(!T.has(t)){T.add(t),z.children[x-w].children[A-C]=t;let l=e.api.findPath(t);k.push([t,l])}if(A+1<=S)A+=1;else if(x+1<=N)A=C,x+=1;else break}let R=a||"table";return"cell"===R?k:(null==(l=z.children)||l.forEach(e=>{var t;e.children=null==(t=e.children)?void 0:t.filter(e=>i.table.getCellChildren(e).length>0)}),"table"===R)?[[z,d]]:{cellEntries:k,tableEntries:[[z,d]]}})(e,{at:l,format:r});let c=l.anchor.path,f=l.focus.path,u=c.at(-2),d=f.at(-2),p=c.at(-1),h=f.at(-1),m=Math.min(u,d),b=Math.max(u,d),v=Math.min(p,h),w=Math.max(p,h),N=c.slice(0,-2),C=a.create.table({children:[],colCount:w-v+1,rowCount:b-m+1}),S=m,_=v,E=[];for(;;){let t=N.concat([S,_]),l=o.lZ.get(e,t);if(!l)break;if(C.children[S-m].children[_-v]=l,E.push([l,t]),_+1<=w)_+=1;else if(S+1<=b)_=v,S+=1;else break}return"cell"===r?E:[[C,N]]})(e,{at:{anchor:{offset:0,path:t[1]},focus:{offset:0,path:l[1]}},format:a});if("table"===a){let e=f.create.table({rowCount:1});return e.children[0].children=[t[0]],[[e,t[1].slice(0,-2)]]}return[t]}return[]},I=(e,t)=>{let l=x(e);return(e.colSizes?[...e.colSizes]:Array.from({length:l}).fill(0)).map((e,l)=>{var r,a;return null!=(r=null==t||null==(a=t.get)?void 0:a.call(t,l))?r:e})},Z=(e,t)=>{let[l,r]=o.Cb.edges(e.selection),a=o.lZ.child(t[0],0),i=o.lZ.child(t[0],t[0].children.length-1),s=e.api.above({at:l,match:e=>e.type===n.t.tr}),c=e.api.above({at:r,match:e=>e.type===n.t.tr});s&&c&&a.id===s[0].id&&c[0].id===i.id&&G(e)},G=e=>{let t=R(e,{format:"cell"}),l=[];t.forEach(t=>{let[r,a]=t;l.push(e.api.pathRef(a))}),l.forEach(t=>{e.tf.removeNodes({at:t.unref()})})},D=(e,t,l,r)=>{let[a,i]=t,n=a.children[l].children.findIndex(t=>{let{col:l}=g(e,t);return l===r});return i.concat([l,n])},O=(e,t)=>{let[l,r]=t,{api:a}=(0,s.Gt)(e,en),i=B(l),n=R(e,{format:"cell"}),o=v(n[0][1]);if(null===o)return;let c=0,f=-1,u=0,d=0;if(n.forEach(e=>{var t;let[l,r]=e;r.at(-2)===o&&(c+=null!=(t=l.colSpan)?t:1);let i=v(r);if(f!==i){if(0!==u)return void u--;let e=a.table.getRowSpan(l);u=e&&e>1?e-1:0,d+=null!=e?e:1}f=i}),c===i){let t=[];for(let l=o;l<o+d;l++){let a=r.concat(l);t.push(e.api.pathRef(a))}t.forEach(t=>{e.tf.removeNodes({at:t.unref()})})}},B=e=>{var t,l,r;return null==(r=e.children)||null==(l=r[0])||null==(t=l.children)?void 0:t.reduce((e,t)=>{var l;return e+(null!=(l=m(t))?l:1)},0)},j=function(e){let t,l,{at:i,before:c,fromCell:f,header:d,select:p}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{api:h,getOptions:m,type:b}=(0,s.Gt)(e,en),{initialTableWidth:v,minColumnWidth:w}=m();if(i&&!f){var N;(null==(N=o.lZ.get(e,i))?void 0:N.type)===e.getType(n.t.table)&&(f=o.lZ.lastChild(e,i.concat([0]))[1],i=void 0)}let C=f?e.api.node({at:f,match:{type:y(e)}}):e.api.block({match:{type:y(e)}});if(!C)return;let[,S]=C,_=C[0],E=e.api.block({above:!0,at:S,match:{type:b}});if(!E)return;let[z,k]=E,{col:T}=g(e,_),x=h.table.getColSpan(_);o.s2.isPath(i)?(t=T,l=T-1):(t=c?T:T+x,l=c?T:T+x-1);let A=z.children.length,P=t<=0,R=+!c;P&&(l=0,R=0);let I=new Set;Array.from({length:A},(e,t)=>t).forEach(t=>{let r=M(e,z,t,l);r&&I.add(r)}),Array.from(I).forEach(l=>{let{col:i,row:n}=g(e,l),o=h.table.getRowSpan(l),s=h.table.getColSpan(l),f=D(e,E,n,i);if(!(i+s-1>=t)||P||c){let t=f.slice(0,-1),l=f.at(-1),i=[...t,c?l:l+R],n=e.api.parent(f)[0],s=(0,a._)((0,r._)({},h.create.tableCell({header:d,row:n})),{colSpan:1,rowSpan:o});e.tf.insertNodes(s,{at:i,select:p})}else{var m;let t=s+1,i=u((0,a._)((0,r._)({},l),{colSpan:t}));(null==(m=i.attributes)?void 0:m.colspan)&&(i.attributes.colspan=t.toString()),e.tf.setNodes(i,{at:f})}}),e.tf.withoutNormalizing(()=>{let{colSizes:l}=z;if(l){let i=[...l.slice(0,t),0,...l.slice(t)];if(v){var r,a;i[t]=null!=(r=null!=(a=l[t])?a:l[t-1])?r:v/l.length;let e=l.reduce((e,t)=>e+t,0),n=i.reduce((e,t)=>e+t,0),o=Math.max(e,v);if(n>o){let e=o/n;i=i.map(t=>Math.max(null!=w?w:0,Math.floor(t*e)))}}e.tf.setNodes({colSizes:i},{at:k})}})},q=function(e){let t,l,i,{at:c,before:f,fromRow:d,header:p,select:h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{api:m,type:b}=(0,s.Gt)(e,en);if(c&&!d){var v;(null==(v=o.lZ.get(e,c))?void 0:v.type)===e.getType(n.t.table)&&(d=o.lZ.lastChild(e,c)[1],c=void 0)}let w=e.api.block({at:d,match:{type:e.getType(n.t.tr)}});if(!w)return;let[,N]=w,C=e.api.block({above:!0,at:N,match:{type:b}});if(!C)return;let S=C[0],_=e.api.node({at:d,match:{type:y(e)}});if(!_)return;let[E,z]=_,k=m.table.getRowSpan(E),{row:T}=g(e,E),A=z.at(-2),P=z.slice(0,-2);o.s2.isPath(c)?(t=c.at(-1),l=T-1,i=c):(t=f?T:T+k,l=f?T-1:T+k-1,i=[...P,f?A:A+k]);let R=0===t;R&&(l=0);let I=x(S),Z=new Set;Array.from({length:I},(e,t)=>t).forEach(t=>{let r=M(e,S,l,t);r&&Z.add(r)});let G=Array.from(Z),O=[];G.forEach(l=>{if(!l)return;let{col:i,row:n}=g(e,l),o=m.table.getRowSpan(l),s=m.table.getColSpan(l),c=D(e,C,n,i);if(n+o-1>=t&&!R){var f;let t=o+1,i=u((0,a._)((0,r._)({},l),{rowSpan:t}));(null==(f=i.attributes)?void 0:f.rowspan)&&(i.attributes.rowspan=t.toString()),e.tf.setNodes(i,{at:c})}else{let t=e.api.parent(c)[0],l=m.create.tableCell({header:p,row:t});O.push((0,a._)((0,r._)({},l),{colSpan:s,rowSpan:1}))}}),e.tf.withoutNormalizing(()=>{if(e.tf.insertNodes({children:O,type:e.getType(n.t.tr)},{at:i,select:!1}),h){let t=e.api.node({at:i,match:{type:y(e)}});if(t){let[,l]=t;e.tf.select(l)}}})},L=e=>{var t;let l=[];return null==e||null==(t=e.children)||t.forEach((e,t)=>{var r;null==(r=e.children)||r.forEach(e=>{Array.from({length:N(e)||1}).forEach((r,a)=>{l[t+a]||(l[t+a]=0),l[t+a]+=m(e)})})}),l.every(e=>e===l[0])},H=e=>{let{api:t}=(0,s.Gt)(e,en),l=R(e,{format:"cell"});e.tf.withoutNormalizing(()=>{let i=0;for(let e of l){let[r,a]=e;a.at(-2)===l[0][1].at(-2)&&(i+=t.table.getColSpan(r))}let o=0,{col:s}=g(e,l[0][0]);l.forEach(l=>{let r=l[0],{col:a}=g(e,r);s===a&&(o+=t.table.getRowSpan(r))});let c=[];for(let r of l){let[l]=r,a=t.table.getCellChildren(l);1===a.length&&e.api.isEmpty(a[0])||c.push(...u(a))}let f={};l.forEach(e=>{let[t,l]=e,r=l.at(-2);f[r]?f[r].push(l):f[r]=[l]}),Object.values(f).forEach(t=>{null==t||t.forEach(()=>{e.tf.removeNodes({at:t[0]})})});let d=(0,a._)((0,r._)({},t.create.tableCell({children:c,header:l[0][0].type===e.getType(n.t.th)})),{colSpan:i,rowSpan:o});e.tf.insertNodes(d,{at:l[0][1]})}),e.tf.select(e.api.end(l[0][1]))},K=e=>{let{api:t}=(0,s.Gt)(e,en),l=e.getType(n.t.tr),[[i,o]]=R(e,{format:"cell"});e.tf.withoutNormalizing(()=>{let s=l=>(0,a._)((0,r._)({},t.create.tableCell({children:l,header:i.type===e.getType(n.t.th)})),{colSpan:1,rowSpan:1}),c=o.slice(0,-2),[f,u]=o.slice(-2),d=t.table.getColSpan(i),p=t.table.getRowSpan(i),h=[];for(let e=0;e<d;e++)h.push(u+e);let{col:m}=g(e,i);e.tf.removeNodes({at:o});let b=(t,r)=>{let a=e.api.node({at:[...c,t],match:{type:l}});if(!a)return 0;let i=a[0],n=[],o=1/0,s=!1;if(i.children.forEach(t=>{let{col:l}=g(e,t),a=Math.abs(l-r);a<o&&(o=a,n=e.api.findPath(t),s=l<r)}),n.length>0){let e=n.at(-1);return s?e+1:e}return 1};for(let r=0;r<p;r++){let a=f+r,o=b(a,m),u=[],d=[...c,a],p=e.api.node({at:d,match:{type:l}});for(let l=0;l<h.length;l++){let n=t.table.getCellChildren(i),f=0===r&&0===l?s(n):s();if(p){let t=[...c,a,0===r?h[l]:o];e.tf.insertNodes(f,{at:t})}else u.push(f)}p||e.tf.insertNodes({children:u,type:e.getType(n.t.tr)},{at:d})}}),e.tf.select(e.api.end(o))},Q=e=>{let{getOptions:t,type:l}=(0,s.Gt)(e,{key:n.t.table}),{disableMerge:i}=t(),o=e.api.above({match:{type:l}});o&&e.tf.withoutNormalizing(()=>{if(!i){let t,l;return void(t=e.getType(n.t.table),(l=e.api.above({match:{type:t}}))&&e.tf.withoutNormalizing(()=>{let{api:t}=(0,s.Gt)(e,en);if(e.api.isExpanded())return Z(e,l);let i=l[0],o=e.api.above({match:{type:y(e)}});if(!o)return;let c=o[0],{col:f}=g(e,c),d=t.table.getColSpan(c),p=f+d-1,h=i.children.length,m=new Set;for(let t of Array.from({length:h},(e,t)=>t))for(let l of Array.from({length:d},(e,t)=>t)){let r=M(e,i,t,f+l);r&&m.add(r)}let b=Array.from(m),{squizeColSpanCells:v}=b.reduce((l,r)=>{if(!r)return l;let{col:a}=g(e,r),i=t.table.getColSpan(r);return a<f&&i>1?l.squizeColSpanCells.push(r):i>1&&a+i-1>p&&l.squizeColSpanCells.push(r),l},{squizeColSpanCells:[]});v.forEach(i=>{var n;let{col:o,row:s}=g(e,i),c=t.table.getColSpan(i),d=D(e,l,s,o),h=c-(Math.min(o+c-1,p)-f+1),m=u((0,a._)((0,r._)({},i),{colSpan:h}));(null==(n=m.attributes)?void 0:n.colspan)&&(m.attributes.colspan=h.toString()),e.tf.setNodes(m,{at:d})});let w=e.api.above({match:{type:e.getType(n.t.tr)}});if(c&&w&&l&&w[0].children.length>1){let[t,r]=l,a=[];b.forEach(t=>{let{col:r,row:i}=g(e,t);if(!v.includes(t)&&r>=f&&r<=p){let t=D(e,l,i,r);a[i]||(a[i]=[]),a[i].push(t)}}),a.forEach(t=>{let l=t[0];t.forEach(()=>{e.tf.removeNodes({at:l})})});let{colSizes:i}=t;if(i){let t=[...i];t.splice(f,1),e.tf.setNodes({colSizes:t},{at:r})}}}))}if(e.api.isExpanded())return Z(e,o);let t=e.api.above({match:{type:y(e)}}),l=e.api.above({match:{type:e.getType(n.t.tr)}});if(t&&l&&o&&l[0].children.length>1){let[l,r]=o,a=t[1],i=a.at(-1),n=a.slice(),s=n.length-2;l.children.forEach((t,l)=>{n[s]=l,1===t.children.length||i>t.children.length-1||e.tf.removeNodes({at:n})});let{colSizes:c}=l;if(c){let t=[...c];t.splice(i,1),e.tf.setNodes({colSizes:t},{at:r})}}})},F=e=>{let{getOptions:t,type:l}=(0,s.Gt)(e,{key:n.t.table}),{disableMerge:i}=t();if(!i)return(e=>{let{api:t,tf:l,type:i}=(0,s.Gt)(e,{key:n.t.table});if(e.api.some({match:{type:i}})){let n=e.api.above({match:{type:i}});if(!n)return;if(e.api.isExpanded())return O(e,n);let s=n[0],f=e.api.above({match:{type:y(e)}});if(!f)return;let d=f[0],{row:p}=g(e,d),h=t.table.getRowSpan(d),m=p+h-1,b=x(s),v=new Set;for(let t of Array.from({length:b},(e,t)=>t))for(let l of Array.from({length:h},(e,t)=>t)){let r=M(e,s,p+l,t);v.add(r)}let{moveToNextRowCells:w,squizeRowSpanCells:N}=Array.from(v).reduce((l,r)=>{if(!r)return l;let{row:a}=g(e,r),i=t.table.getRowSpan(r);return a<p&&i>1?l.squizeRowSpanCells.push(r):i>1&&a+i-1>m&&l.moveToNextRowCells.push(r),l},{moveToNextRowCells:[],squizeRowSpanCells:[]}),C=p+h,S=s.children[C];if(void 0===S&&0===p)return void l.remove.table();if(S)for(let l=0;l<w.length;l++){var o,c;let i=w[l],{col:n,row:s}=g(e,i),f=t.table.getRowSpan(i),d=S.children.findIndex(t=>{let{col:l}=g(e,t);return l>=n});if(-1===d){let t=S.children.at(-1),n=e.api.findPath(t),o=[...n.slice(0,-2),C,n.at(-1)+l+1],d=f-(m-s+1),p=u((0,a._)((0,r._)({},i),{rowSpan:d}));(null==(c=p.attributes)?void 0:c.rowspan)&&(p.attributes.rowspan=d.toString()),e.tf.insertNodes(p,{at:o});continue}let p=S.children[d],{col:h}=g(e,p),b=l;h<n&&(b+=1);let v=e.api.findPath(p),y=[...v.slice(0,-2),C,v.at(-1)+b],N=f-(m-s+1),_=u((0,a._)((0,r._)({},i),{rowSpan:N}));(null==(o=_.attributes)?void 0:o.rowspan)&&(_.attributes.rowspan=N.toString()),e.tf.insertNodes(_,{at:y})}N.forEach(l=>{var i;let{row:n}=g(e,l),o=t.table.getRowSpan(l),s=e.api.findPath(l),c=o-(Math.min(n+o-1,m)-p+1),f=u((0,a._)((0,r._)({},l),{rowSpan:c}));(null==(i=f.attributes)?void 0:i.rowspan)&&(f.attributes.rowspan=c.toString()),e.tf.setNodes(f,{at:s})});let _=s.children[p],E=e.api.findPath(_);Array.from({length:h}).forEach(()=>{e.tf.removeNodes({at:E})})}})(e);if(e.api.some({match:{type:l}})){let t=e.api.above({match:{type:l}});if(!t)return;if(e.api.isExpanded())return O(e,t);let r=e.api.above({match:{type:e.getType(n.t.tr)}});r&&t&&t[0].children.length>1&&e.tf.removeNodes({at:r[1]})}},W=e=>{if(e.api.some({match:{type:e.getType(n.t.table)}})){let t=e.api.above({match:{type:e.getType(n.t.table)}});t&&e.tf.removeNodes({at:t[1]})}},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,[{colCount:a=2,header:s,rowCount:c=2}={},...f]=[t,l],[u={}]=f,{select:d}=u,p=(0,i._)(u,["select"]),{api:h}=e.getPlugin({key:n.t.table}),m=e.getType(n.t.table);e.tf.withoutNormalizing(()=>{let t=h.create.table({colCount:a,header:s,rowCount:c});if(!p.at){let l=e.api.block({match:{type:m}});if(l){let[,a]=l,i=o.s2.next(a);e.tf.insertNodes(t,(0,r._)({at:i},p)),e.selection&&e.tf.select(e.api.start(i));return}}if(e.tf.insertNodes(t,(0,r._)({nextBlock:!p.at,select:d},p)),d){let t=e.api.node({at:p.at,match:{type:m}});if(!t)return;e.tf.select(e.api.start(t[1]))}})},U=function(e){let t,l,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{api:a,getOptions:i,type:c}=(0,s.Gt)(e,en),{disableMerge:f,initialTableWidth:u,minColumnWidth:d}=i();if(!f)return j(e,r);let{before:p,header:h,select:m}=r,{at:b,fromCell:g}=r;if(b&&!g){var v;(null==(v=o.lZ.get(e,b))?void 0:v.type)===e.getType(n.t.table)&&(g=o.lZ.lastChild(e,b.concat([0]))[1],b=void 0)}let w=e.api.block({at:g,match:{type:y(e)}});if(!w)return;let[,N]=w,C=e.api.block({above:!0,at:N,match:{type:c}});if(!C)return;let[S,_]=C;o.s2.isPath(b)?(t=b,l=b.at(-1)):(t=p?N:o.s2.next(N),l=p?N.at(-1):N.at(-1)+1);let E=N.at(-2);e.tf.withoutNormalizing(()=>{S.children.forEach((l,r)=>{let i=[...t];o.s2.isPath(b)?i[b.length-2]=r:i[N.length-2]=r;let s=void 0===h?l.children.every(t=>t.type===e.getType(n.t.th)):h;e.tf.insertNodes(a.create.tableCell({header:s}),{at:i,select:m&&r===E})});let{colSizes:r}=S;if(r){let t=[...r.slice(0,l),0,...r.slice(l)];if(u){var i,s;t[l]=null!=(i=null!=(s=r[l])?s:r[l-1])?i:u/r.length;let e=r.reduce((e,t)=>e+t,0),a=t.reduce((e,t)=>e+t,0),n=Math.max(e,u);if(a>n){let e=n/a;t=t.map(t=>Math.max(null!=d?d:0,Math.floor(t*e)))}}e.tf.setNodes({colSizes:t},{at:_})}})},V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{api:l,getOptions:r,type:a}=(0,s.Gt)(e,en),{disableMerge:i}=r();if(!i)return q(e,t);let{before:c,header:f,select:u}=t,{at:d,fromRow:p}=t;if(d&&!p){var h;(null==(h=o.lZ.get(e,d))?void 0:h.type)===e.getType(n.t.table)&&(p=o.lZ.lastChild(e,d)[1],d=void 0)}let m=e.api.block({at:p,match:{type:e.getType(n.t.tr)}});if(!m)return;let[b,g]=m,v=e.api.block({above:!0,at:g,match:{type:a}});if(v&&(e.tf.withoutNormalizing(()=>{e.tf.insertNodes({children:b.children.map((t,r)=>{let a=1!==v[0].children.length&&v[0].children.every(t=>t.children[r].type===e.getType(n.t.th));return l.create.tableCell({header:null!=f?f:a})}),type:e.getType(n.t.tr)},{at:o.s2.isPath(d)?d:c?g:o.s2.next(g)})}),u)){let t=e.api.block({match:{type:y(e)}});if(!t)return;let[,l]=t;o.s2.isPath(d)?l[l.length-2]=d.at(-2):l[l.length-2]=c?l.at(-2):l.at(-2)+1,e.tf.select(l)}},J=function(e){let{at:t,edge:l,fromOneCell:r,reverse:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l){let a=R(e,{at:t,format:"cell"});if(a.length>+!r){let[,t]=a[0],[,r]=a.at(-1),i=[...t],n=[...r];switch(l){case"bottom":n[n.length-2]+=1;break;case"left":i[i.length-1]-=1;break;case"right":n[n.length-1]+=1;break;case"top":i[i.length-2]-=1}return o.lZ.has(e,i)&&o.lZ.has(e,n)&&e.tf.select({anchor:e.api.start(i),focus:e.api.start(n)}),!0}return}let i=e.api.block({at:t,match:{type:y(e)}});if(i){let[,t]=i,l=[...t];if(l[l.length-2]+=a?-1:1,o.lZ.has(e,l))e.tf.select(e.api.start(l));else{let l=t.slice(0,-2);a?e.tf.withoutNormalizing(()=>{e.tf.select(e.api.start(l)),e.tf.move({reverse:!0})}):e.tf.withoutNormalizing(()=>{e.tf.select(e.api.end(l)),e.tf.move()})}return!0}},Y=function(e,t){let{at:l,border:i="all"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.api.node({at:l,match:{type:y(e)}});if(!n)return;let[s,c]=n,f=c.at(-1),u=c.at(-2),d={size:t},p={match:t=>o.$7.isElement(t)&&y(e).includes(t.type)};if("top"===i){if(0===u){let t=(0,a._)((0,r._)({},s.borders),{top:d});e.tf.setNodes({borders:t},(0,r._)({at:c},p));return}let t=S(e,{at:c});if(!t)return;let[l,i]=t,n=(0,a._)((0,r._)({},l.borders),{bottom:d});e.tf.setNodes({borders:n},(0,r._)({at:i},p))}else if("bottom"===i){let t=(0,a._)((0,r._)({},s.borders),{bottom:d});e.tf.setNodes({borders:t},(0,r._)({at:c},p))}if("left"===i){if(0===f){let t=(0,a._)((0,r._)({},s.borders),{left:d});e.tf.setNodes({borders:t},(0,r._)({at:c},p));return}let t=w(e,{at:c});if(!t)return;let[l,i]=t,n=(0,a._)((0,r._)({},l.borders),{right:d});e.tf.setNodes({borders:n},(0,r._)({at:i},p))}else if("right"===i){let t=(0,a._)((0,r._)({},s.borders),{right:d});e.tf.setNodes({borders:t},(0,r._)({at:c},p))}"all"===i&&e.tf.withoutNormalizing(()=>{Y(e,t,{at:l,border:"top"}),Y(e,t,{at:l,border:"bottom"}),Y(e,t,{at:l,border:"left"}),Y(e,t,{at:l,border:"right"})})},X=function(e,t){let{colIndex:l,width:a}=t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.api.node((0,r._)({match:{type:n.t.table}},i));if(!o)return;let[s,c]=o,f=s.colSizes?[...s.colSizes]:Array.from({length:x(s)}).fill(0);f[l]=a,e.tf.setNodes({colSizes:f},{at:c})},ee=function(e,t){let{marginLeft:l}=t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.api.node((0,r._)({match:{type:n.t.table}},a));if(!i)return;let[,o]=i;e.tf.setNodes({marginLeft:l},{at:o})},et=function(e,t){let{height:l,rowIndex:a}=t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.api.node((0,r._)({match:{type:n.t.table}},i));if(!o)return;let[,s]=o,c=[...s,a];e.tf.setNodes({size:l},{at:c})},el=e=>{let{element:t,type:l}=e,r=t.style.background||t.style.backgroundColor;return r?{background:r,type:l}:{type:l}},er=(0,s.Kt)({key:n.t.tr,node:{isContainer:!0,isElement:!0,isStrictSiblings:!0},parsers:{html:{deserializer:{rules:[{validNodeName:"TR"}]}}}}),ea=(0,s.Kt)({key:n.t.td,node:{dangerouslyAllowAttributes:["colspan","rowspan"],isContainer:!0,isElement:!0,isStrictSiblings:!0,props:e=>{var t,l;let{element:r}=e;return{colSpan:null==r||null==(t=r.attributes)?void 0:t.colspan,rowSpan:null==r||null==(l=r.attributes)?void 0:l.rowspan}}},parsers:{html:{deserializer:{attributeNames:["rowspan","colspan"],parse:el,rules:[{validNodeName:"TD"}]}}},rules:{merge:{removeEmpty:!1}}}),ei=(0,s.Kt)({key:n.t.th,node:{dangerouslyAllowAttributes:["colspan","rowspan"],isContainer:!0,isElement:!0,isStrictSiblings:!0,props:e=>{var t,l;let{element:r}=e;return{colSpan:null==r||null==(t=r.attributes)?void 0:t.colspan,rowSpan:null==r||null==(l=r.attributes)?void 0:l.rowspan}}},parsers:{html:{deserializer:{attributeNames:["rowspan","colspan"],parse:el,rules:[{validNodeName:"TH"}]}}},rules:{merge:{removeEmpty:!1}}}),en=(0,s.qt)({key:n.t.table,node:{isContainer:!0,isElement:!0},normalizeInitialValue:e=>{let{editor:t,type:l}=e;for(let[e]of t.api.nodes({at:[],match:{type:l}}))b(t,{tableNode:e})},options:{_cellIndices:{},disableMerge:!1,minColumnWidth:48,selectedCells:null,selectedTables:null},parsers:{html:{deserializer:{rules:[{validNodeName:"TABLE"}]}}},plugins:[er,ea,ei]}).extendSelectors(e=>{let{getOptions:t}=e;return{cellIndices:e=>t()._cellIndices[e]}}).extendEditorApi(e=>{let{editor:t}=e;return{create:{table:(0,f.gv)(h,t),tableCell:(0,f.gv)(d,t),tableRow:(0,f.gv)(p,t)},table:{getCellBorders:(0,f.gv)(k,t),getCellSize:(0,f.gv)(T,t),getColSpan:m,getRowSpan:N,getCellChildren:e=>e.children}}}).extendEditorTransforms(e=>{let{editor:t}=e;return{insert:{table:(0,f.gv)($,t),tableColumn:(0,f.gv)(U,t),tableRow:(0,f.gv)(V,t)},remove:{table:(0,f.gv)(W,t),tableColumn:(0,f.gv)(Q,t),tableRow:(0,f.gv)(F,t)},table:{merge:(0,f.gv)(H,t),split:(0,f.gv)(K,t)}}}).overrideEditor(e=>{let{editor:t,tf:{selectAll:l,tab:i},type:s}=e,f=(e=>{let{api:{marks:t},editor:l,tf:{addMark:i,removeMark:n,setNodes:s}}=e;return{api:{marks(){let e=(()=>{let{selection:e}=l;if(!e||l.api.isCollapsed())return;let t=R(l,{format:"cell"});if(t.length<=1)return;let r={},a={},i=0;return t.forEach(e=>{let[t,n]=e;Array.from(l.api.nodes({at:n,match:e=>o.Qg.isText(e)}),e=>e[0]).forEach(e=>{i++;let t=Object.keys(e);1!==t.length&&(t.splice(t.indexOf("text"),1),t.forEach(t=>{r[t]=(r[t]||0)+1,a[t]=e[t]}))})}),Object.keys(r).forEach(e=>{r[e]!==i&&delete a[e]}),a})();return e||t()}},transforms:{addMark(e,t){if(!(()=>{let{selection:r}=l;if(!r||l.api.isCollapsed()||l.meta.isNormalizing)return;let a=R(l,{format:"cell"});if(!(a.length<=1))return a.forEach(r=>{let[a,i]=r;l.tf.setNodes({[e]:t},{at:i,split:!0,voids:!0,match:e=>o.Qg.isText(e)})}),!0})())return i(e,t)},removeMark(e){if(!(()=>{let{selection:t}=l;if(!t||l.api.isCollapsed()||l.meta.isNormalizing)return;let r=R(l,{format:"cell"});if(!(r.length<=1))return r.forEach(t=>{let[r,a]=t;l.tf.setNodes({[e]:null},{at:a,split:!0,voids:!0,match:e=>o.Qg.isText(e)})}),!0})())return n(e)},setNodes(e,t){if(!(()=>{let{selection:i}=l;if(!i||l.api.isCollapsed()||l.meta.isNormalizing)return;if(null==t?void 0:t.at){let e=l.api.range(t.at);if(e&&!o.Cb.includes(i,e))return}let n=R(l,{format:"cell"});if(!(n.length<=1))return s(e,(0,a._)((0,r._)({},t),{match:(0,o.f4)(l,(e,t)=>n.some(e=>{let[l,r]=e;return o.s2.isCommon(r,t)}),t)})),!0})())return s(e,t)}}}})(e);return{api:(0,r._)({},(e=>{let{api:t,api:{getFragment:l},editor:r,type:a}=e;return{api:{getFragment(){let e=l(),i=[];return e.forEach(e=>{if(e.type===a){let l=e.children,a=l.length;if(!a)return;let n=l[0].children.length;if(a<=1&&n<=1){let e=l[0],r=t.table.getCellChildren(e);i.push(...r[0].children);return}let o=R(r);if(o.length>0)return void i.push(o[0][0])}i.push(e)}),i}}}})(e).api,f.api),transforms:(0,r._)({selectAll:()=>!!(()=>{let e=t.api.above({match:{type:s}});if(!e)return;let[,l]=e;return t.tf.select(l),!0})()||l(),tab:e=>!!(()=>{if(t.selection&&t.api.isExpanded()&&Array.from(t.api.nodes({at:t.selection,match:{type:y(t)}})).length>1)return t.tf.collapse({edge:"end"}),!0;let l=A(t);if(!l)return;let{cell:r,row:a}=l,[,i]=r;if(e.reverse){let e=((e,t,l,r)=>{let a=o.s2.previous(l);if(!a){let[,t]=r;return((e,t)=>{var l;let r=o.s2.previous(t);if(!r)return;let a=e.api.node(r);if(!a)return;let[i,n]=a,s=null==i||null==(l=i.children)?void 0:l[i.children.length-1],c=n.concat(i.children.length-1);if(s&&c)return e.api.node(c)})(e,t)}let i=e.api.node(a);if(i)return i})(t,0,i,a);if(e){let[,l]=e;t.tf.select(l)}}else{let e=((e,t,l,r)=>{let a=e.api.node(o.s2.next(l));if(a)return a;let[,i]=r;return((e,t)=>{var l;let r=e.api.node(o.s2.next(t));if(!r)return;let[a,i]=r,n=null==a||null==(l=a.children)?void 0:l[0],s=i.concat(0);if(n&&s)return e.api.node(s)})(e,i)})(t,0,i,a);if(e){let[,l]=e;t.tf.select(l)}}return!0})()||i(e)},(e=>{let{editor:t,getOption:l,getOptions:r,tf:{normalizeNode:a},type:i}=e;return{transforms:{normalizeNode(e){let[s,c]=e,{enableUnsetSingleColSize:f,initialTableWidth:u}=r();if(o.$7.isElement(s)){var d,p,h,m;if(s.type===i){if(!s.children.some(e=>o.$7.isElement(e)&&e.type===t.getType(n.t.tr)))return void t.tf.removeNodes({at:c});if(s.colSizes&&s.colSizes.length>0&&f&&2>x(s))return void t.tf.unsetNodes("colSizes",{at:c});if(t.api.block({above:!0,at:c,match:{type:i}}))return void t.tf.unwrapNodes({at:c});if(u){let e=null==(p=s.children[0])||null==(d=p.children)?void 0:d.length;if(e){let l=[];if(s.colSizes)s.colSizes.some(e=>!e)&&s.colSizes.forEach(t=>{l.push(t||u/e)});else for(let t=0;t<e;t++)l.push(u/e);if(l.length>0)return void t.tf.setNodes({colSizes:l},{at:c})}}}if(s.type===t.getType(n.t.tr)&&(null==(h=t.api.parent(c))?void 0:h[0].type)!==i)return void t.tf.unwrapNodes({at:c});if(y(t).includes(s.type)){let e=l("cellIndices",s.id);s.id&&!e&&b(t,{all:!0,cellNode:s});let{children:r}=s;if((null==(m=t.api.parent(c))?void 0:m[0].type)!==t.getType(n.t.tr))return void t.tf.unwrapNodes({at:c});if(o.Qg.isText(r[0]))return void t.tf.wrapNodes(t.api.create.block({},c),{at:c,children:!0})}}a([s,c])}}}})(e).transforms,(e=>{let{editor:t,tf:{deleteFragment:l},type:r}=e;return{transforms:{deleteFragment(e){if(t.api.isAt({block:!0,match:e=>e.type===r})){let e=R(t,{format:"cell"});if(e.length>1)return void t.tf.withoutNormalizing(()=>{e.forEach(e=>{let[,l]=e;t.tf.replaceNodes(t.api.create.block(),{at:l,children:!0})}),t.tf.select({anchor:t.api.start(e[0][1]),focus:t.api.end(e.at(-1)[1])})})}l(e)}}}})(e).transforms,(e=>{let{api:t,editor:l,getOptions:r,tf:{insert:a,insertFragment:i},type:s}=e;return{transforms:{insertFragment(e){var c,f,d;let p=e.find(e=>e.type===s);if(!p&&z(l,{at:null==(c=l.selection)?void 0:c.anchor})){let t=R(l,{format:"cell"});if(t.length>1){t.forEach(t=>{if(t){let[,r]=t;l.tf.replaceNodes(u(e),{at:r,children:!0})}}),l.tf.select({anchor:l.api.start(t[0][1]),focus:l.api.end(t.at(-1)[1])});return}}if(p){if(z(l,{at:null==(f=l.selection)?void 0:f.anchor})){let[e]=R(l,{at:null==(d=l.selection)?void 0:d.anchor,format:"cell"});if(e)return void l.tf.withoutNormalizing(()=>{let[,i]=e,n=[...i],s=n.at(-1),c=null,f=!0;p.children.forEach(e=>{if(n[n.length-1]=s,!f){let e=n.slice(0,-1);if(n[n.length-2]+=1,!o.lZ.has(l,n)){if(r().disableExpandOnInsert)return;a.tableRow({fromRow:e})}}f=!1;let i=e.children,d=!0;i.forEach(e=>{if(!d){let e=[...n];if(n[n.length-1]+=1,!o.lZ.has(l,n)){if(r().disableExpandOnInsert)return;a.tableColumn({fromCell:e})}}d=!1;let i=t.table.getCellChildren(e);l.tf.replaceNodes(u(i),{at:n,children:!0}),c=[...n]})}),c&&l.tf.select({anchor:l.api.start(i),focus:l.api.end(c)})})}else if(1===e.length&&e[0].type===n.t.table)return void l.tf.insertNodes(e[0])}i(e)}}}})(e).transforms,(e=>{let{editor:t,tf:{insertText:l}}=e;return{transforms:{insertText(e,r){if(t.api.isExpanded()){var a;z(t,{at:null==(a=t.selection)?void 0:a.anchor})&&R(t,{format:"cell"}).length>1&&t.tf.collapse({edge:"focus"})}l(e,r)}}}})(e).transforms,(e=>{let{api:t,editor:l,getOptions:a,tf:{apply:i},type:s}=e;return{transforms:{apply(e){var t,f;let u;if("set_selection"===e.type&&e.newProperties){let t=(0,r._)({},l.selection,e.newProperties);if(o.Cb.isRange(t)&&l.api.isAt({at:t,blocks:!0,match:e=>e.type===s})){let r=l.api.block({at:t.anchor,match:e=>e.type===s});if(r){let[,a]=r;o.Cb.isBackward(t)?e.newProperties.focus=l.api.start(a):l.api.before(a)&&(e.newProperties.focus=l.api.end(a))}else{let r=l.api.block({at:t.focus,match:e=>e.type===s});if(r){let[,a]=r;if(o.Cb.isBackward(t)){let t=l.api.start(a),r=l.api.before(t);e.newProperties.focus=null!=r?r:t}else e.newProperties.focus=l.api.end(a)}}}((e,t)=>{var l;let r;if(!e.dom.currentKeyboardEvent||!["up","down","shift+up","shift+right","shift+down","shift+left"].some(t=>{let l=(0,c.v_)(t,e.dom.currentKeyboardEvent);return l&&(r=t),l})||!(null==(l=e.selection)?void 0:l.focus)||!(null==t?void 0:t.focus)||!e.api.isAt({at:{anchor:e.selection.focus,focus:t.focus},blocks:!0,match:{type:y(e)}})||!r)return;let a=eo[r];if(a&&!e.api.isAt({block:!0,match:{type:y(e)}}))return;let i=e.selection,n=["shift+up","up"].includes(r);setTimeout(()=>{J(e,{at:i,edge:a,fromOneCell:!0,reverse:n})},0)})(l,t)}let d="remove_node"===e.type?e.node.type:"move_node"===e.type?null==(t=l.api.node(e.path))?void 0:t[0].type:void 0,p=("remove_node"===e.type||"move_node"===e.type)&&d&&[l.getType(n.t.tr),s,...y(l)].includes(d);if(p&&"remove_node"===e.type){let t=[...l.api.nodes({at:e.path,match:{type:y(l)}})],r=a()._cellIndices;t.forEach(e=>{let[t]=e;delete r[t.id]})}i(e),p&&d!==s&&(u=null==(f=l.api.node({at:"move_node"===e.type?e.newPath:e.path,match:{type:s}}))?void 0:f[0])&&b(l,{tableNode:u})}}}})(e).transforms,(e=>{let{api:t,editor:l,plugin:r,tf:{setFragmentData:a}}=e;return{transforms:{setFragmentData(e,i){var o;let s=null==(o=R(l,{format:"table"}))?void 0:o[0],c=R(l,{format:"cell"}),f=l.selection;if(!s||!f)return void a(e,i);let[u,d]=s,p=u.children;u.children=u.children.filter(e=>e.children.length>0);let h="",m="",b=document.createElement("div"),g=document.createElement("table");if(s&&f&&1===c.length&&("copy"===i||"cut"===i))return void a(e);l.tf.withoutNormalizing(()=>{p.forEach(r=>{let i=r.children,o=[],s=r.type===l.getType(n.t.th)?document.createElement("th"):document.createElement("tr");i.forEach(r=>{e.clearData();let i=l.api.findPath(r);l.tf.select({anchor:l.api.start(i),focus:l.api.end(i)}),a(e),o.push(e.getData("text/plain"));let n=document.createElement("td");n.colSpan=t.table.getColSpan(r),n.rowSpan=t.table.getRowSpan(r),n.innerHTML=e.getData("text/html"),s.append(n)}),g.append(s),h+="".concat(o.join(","),"\n"),m+="".concat(o.join("	"),"\n")});let i=l.api.node({at:d,match:{type:n.t.table}});if(null!=i&&i.length>0){let e=i[0];null!=e.attributes&&Object.entries(e.attributes).forEach(e=>{var t;let[l,a]=e;null!=a&&(null==(t=r.node.dangerouslyAllowAttributes)?void 0:t.includes(l))&&g.setAttribute(l,String(a))})}l.tf.select(f),b.append(g)}),e.setData("text/csv",h),e.setData("text/tsv",m),e.setData("text/plain",m),e.setData("text/html",b.innerHTML);let v=JSON.stringify([u]),y=window.btoa(encodeURIComponent(v));e.setData("application/x-slate-fragment",y)}}}})(e).transforms,f.transforms)}}),eo={"shift+down":"bottom","shift+left":"left","shift+right":"right","shift+up":"top"}}}]);