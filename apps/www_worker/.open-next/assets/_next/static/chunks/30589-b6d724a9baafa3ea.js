"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30589],{30589:(e,t,l)=>{l.d(t,{AZ:()=>g,CB:()=>x,E:()=>b,IV:()=>T,Lf:()=>J,_W:()=>k,s8:()=>A,vO:()=>et});var i=l(99019),n=l(5147),s=l(99680),o=l(87010),r=l(48674),c=l(14796),a=l(50357),d=l(13988),u=l(2498),h=l(28268),p=l(41816),f=l(7620),m=l(97509),v=l(13526),_=l(31135);let g="context",b=(0,h.e3)({key:r.t.blockMenu,editOnly:!0,options:{openId:null,position:{x:-1e4,y:-1e4}}}).extendApi(e=>{let{setOption:t,setOptions:l}=e;return{hide:()=>{l({openId:null,position:{x:-1e4,y:-1e4}})},show:(e,i)=>{i?l({openId:e,position:i}):t("openId",e)}}}).extendApi(e=>{let{api:t,editor:l}=e;return{showContextMenu:(e,i)=>{var n;null==(n=l.getApi({key:r.t.blockSelection}).blockSelection)||n.set(e),t.blockMenu.show(g,i)}}}).extend(e=>{let{api:t}=e;return{handlers:{onMouseDown:e=>{let{event:l,getOptions:i}=e;0===l.button&&i().openId&&(l.preventDefault(),t.blockMenu.hide()),2===l.button&&l.preventDefault()}}}}),S=(e,t)=>{let l=e.getApi(et).blockSelection.getNodes(),i=e.api.node(t);if(!i)return;let[n,s]=i,o=(l.length>0?l:e.api.blocks({mode:"lowest",match:(e,t)=>t.length===s.length})).map(e=>e[0].id);e.getApi(et).blockSelection.set(o.includes(n.id)?o:[n.id])},y=(e,t)=>{var l,i;let{disabledWhenFocused:n=!0,element:s,event:o}=t,{enableContextMenu:r,selectedIds:a}=e.getOptions(et);if(!r)return;if((null==(l=e.selection)?void 0:l.focus)&&n){let t=e.api.above(),l=e.api.findPath(s);if(t&&l&&c.s2.isCommon(l,t[1])){let l=t[0].id,n=e.getOption(et,"isSelected",l),s=(null==(i=o.target.dataset)?void 0:i.plateOpenContextMenu)==="true";if(!n&&!e.api.isVoid(t[0])&&!s)return o.stopPropagation()}}let d=s.id;d&&((null==o?void 0:o.shiftKey)?e.getApi(et).blockSelection.add(d):(null==a?void 0:a.has(d))||e.setOption(et,"selectedIds",new Set([d])))},k=e=>{let{id:t}=(0,h.iQ)();return(0,h.gO)(et,"isSelected",null!=e?e:t)},w=e=>t=>{let{api:l}=t;l.cursorOverlay.removeCursor(e)},x=(0,h.e3)({key:r.t.cursorOverlay,editOnly:{render:!1},options:{cursors:{}}}).extendApi(e=>{let{editor:t,plugin:l}=e;return{addCursor:(e,n)=>{let s=(0,i._)({},t.getOptions(l).cursors);s[e]=(0,i._)({id:e},n),t.setOption(l,"cursors",s)},removeCursor:e=>{let n=(0,i._)({},t.getOptions(l).cursors);n[e]&&(delete n[e],t.setOption(l,"cursors",n))}}}).overrideEditor(e=>{let{api:t,editor:l,getOptions:i,tf:{setSelection:n}}=e;return{transforms:{setSelection(e){var s;(null==(s=i().cursors)?void 0:s.selection)&&setTimeout(()=>{t.cursorOverlay.addCursor("selection",{selection:l.selection})},0),n(e)}}}}).extend(()=>({handlers:{onBlur:e=>{var t,l;let{api:i,editor:n,event:s}=e;n.selection&&(null==(l=s.relatedTarget)||null==(t=l.dataset)?void 0:t.plateFocus)==="true"&&i.cursorOverlay.addCursor("selection",{selection:n.selection})},onDragEnd:w("drag"),onDragLeave:w("drag"),onDragOver:e=>{var t;let{api:l,editor:i,event:n}=e;if(!i.plugins.dnd||i.getOptions({key:r.t.dnd}).isDragging||((null==(t=n.dataTransfer)?void 0:t.types)||[]).some(e=>e.startsWith("Files")))return;let s=i.api.findEventRange(n);s&&l.cursorOverlay.addCursor("drag",{selection:s})},onDrop:w("drag"),onFocus:w("selection")},useHooks:e=>{let{api:t,setOption:l}=e,i=(0,h.gO)(et,"isSelecting");(0,f.useEffect)(()=>{i&&setTimeout(()=>{t.cursorOverlay.removeCursor("selection")},0)},[i,l,t.cursorOverlay])}})),E=Object.freeze([]),A=e=>{let t,l,s,o,r,a,d,u,m=(0,v.c)(21);m[0]!==e?(t=void 0===e?{}:e,m[0]=e,m[1]=t):t=m[1];let{minSelectionWidth:_,refreshOnResize:g}=t,b=void 0===_?1:_,S=void 0===g||g,y=(0,h.Q_)(),k=(0,h.T3)(),w=(0,h.gO)(x,"cursors");m[2]===Symbol.for("react.memo_cache_sentinel")?(l=new WeakMap,m[2]=l):l=m[2];let A=f.useRef(l);m[3]===Symbol.for("react.memo_cache_sentinel")?(s={},m[3]=s):s=m[3];let[T,I]=f.useState(s);m[4]!==k||m[5]!==w||m[6]!==y||m[7]!==b||m[8]!==T?(o=()=>{if(!(null==k?void 0:k.current)||!w)return;let e=0,t=0;if(k){let l=k.current.getBoundingClientRect();e=l.x,t=l.y-k.current.scrollTop}let l=Object.keys(T).length!==Object.keys(w).length,s=Object.fromEntries(Object.entries(w).map(s=>{let[o,r]=s;return[o,(s=>{let{cursor:o}=s,r=o.selection;if(!r)return E;let a=A.current.get(r);if(a)return a;let d=((e,t)=>{let{range:l,xOffset:i,yOffset:n}=t,[s,o]=c.Cb.edges(l),r=e.api.toDOMRange(l);if(!r)return[];let a=[];for(let[t,d]of e.api.nodes({at:l,match:c.Qg.isText})){let l=e.api.toDOMNode(t);if(!(null==l?void 0:l.parentElement))return[];let u=c.s2.equals(d,s.path),h=c.s2.equals(d,o.path),p=null;if(u||h){let e=document.createRange();e.selectNode(l),u&&e.setStart(r.startContainer,r.startOffset),h&&e.setEnd(r.endContainer,r.endOffset),p=e.getClientRects()}else p=l.getClientRects();for(let e=0;e<p.length;e++){let t=p.item(e);t&&a.push({height:t.height,left:t.left-i,top:t.top-n,width:t.width})}}return a})(y,{range:r,xOffset:e,yOffset:t}).map(e=>e.width<b?(0,n._)((0,i._)({},e),{left:e.left-(b-e.width)/2,width:b}):e);return l=!0,A.current.set(r,d),d})({cursor:r})]}));l&&I(s)},m[4]=k,m[5]=w,m[6]=y,m[7]=b,m[8]=T,m[9]=o):o=m[9];let D=o;m[10]!==D?(r=()=>{D()},m[10]=D,m[11]=r):r=m[11],(0,p.Es)(r),m[12]!==w||m[13]!==T?(a=(e=>{let{cursors:t,selectionRects:l}=e;return t?Object.entries(t).map(e=>{var t,s;let o,r,a,[d,u]=e,h=null!=(t=null==u?void 0:u.selection)?t:null,p=null!=(s=l[d])?s:E,f=h?(o=h&&c.Cb.isCollapsed(h),(a=p[(r=h&&c.Cb.isBackward(h))?0:p.length-1])?{height:a.height,left:a.left+(r||o?0:a.width),top:a.top}:null):null;return(0,n._)((0,i._)({},u),{caretPosition:f,selection:h,selectionRects:p})}):[]})({cursors:w,selectionRects:T}),m[12]=w,m[13]=T,m[14]=a):a=m[14];let O=a;m[15]!==k||m[16]!==S?(d={containerRef:k,refreshOnResize:S,selectionRectCache:A},m[15]=k,m[16]=S,m[17]=d):d=m[17];let{refresh:C}=(e=>{let{containerRef:t,refreshOnResize:l,selectionRectCache:i}=e,n=(()=>{let[,e]=f.useState(0),t=f.useRef(null),l=f.useCallback(function(){let l=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t.current||l){if(!l){t.current=requestAnimationFrame(()=>{e(e=>e+1),t.current=null});return}t.current&&(cancelAnimationFrame(t.current),t.current=null),e(e=>e+1)}},[]);return f.useEffect(()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null)}),f.useEffect(()=>()=>{t.current&&cancelAnimationFrame(t.current)},[]),l})(),s=f.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.current=new WeakMap,n(e)},[n,i]);return f.useEffect(()=>{if(!l||!(null==t?void 0:t.current))return;let e=new ResizeObserver(()=>s());return e.observe(t.current),()=>e.disconnect()},[t,s,l]),{refresh:s}})(d);return m[18]!==O||m[19]!==C?(u={cursors:O,refresh:C},m[18]=O,m[19]=C,m[20]=u):u=m[20],u},T=()=>{let e,t=(0,s.c)(1),l=(0,v.c)(1),i=(0,h.gO)(et,"isSelectingSome");if(l[0]===Symbol.for("react.memo_cache_sentinel")){let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=[],t[0]=i):i=t[0],e=i,l[0]=e}else e=l[0];return(0,h.QR)(I,e)||i};function I(e){return e.api.isExpanded()}var D=class{addEventListener(e,t){var l;let i=null!=(l=this._listeners.get(e))?l:new Set;return this._listeners.set(e,i),i.add(t),this}dispatchEvent(e){for(var t,l=arguments.length,i=Array(l>1?l-1:0),n=1;n<l;n++)i[n-1]=arguments[n];let s=!0;for(let l of null!=(t=this._listeners.get(e))?t:[])s=!1!==l(...i)&&s;return s}removeEventListener(e,t){var l;return null==(l=this._listeners.get(e))||l.delete(t),this}unbindAllListeners(){this._listeners.clear()}constructor(){this._listeners=new Map,this.emit=this.dispatchEvent,this.off=this.removeEventListener,this.on=this.addEventListener}};let O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";return"number"==typeof e?e+t:e};function C(e,t,l){let{style:i}=e;if("object"==typeof t)for(let[e,l]of Object.entries(t))void 0!==l&&(i[e]=O(l));else void 0!==l&&(i[t]=O(l))}let R=e=>function(t,l,n){let s,o,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(let c of(s=t instanceof HTMLCollection||t instanceof NodeList?Array.from(t):Array.isArray(t)?t:[t],o=Array.isArray(l)?l:[l],s))if(c)for(let t of o)c[e](t,n,(0,i._)({capture:!1},r));return[s,o,n,r]},L=R("addEventListener"),M=R("removeEventListener"),N=e=>{var t,l;let{clientX:i,clientY:n,target:s}=null!=(t=null==(l=e.touches)?void 0:l[0])?t:e;return{target:s,x:i,y:n}};function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,l=Array.isArray(e)?e:[e],i=[];for(let e=0,n=l.length;e<n;e++){let n=l[e];"string"==typeof n?i=i.concat(Array.from(t.querySelectorAll(n))):n instanceof Element&&i.push(n)}return i}let{abs:P,ceil:B,max:z,min:j}=Math;var K=class extends D{_bindStartEvents(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{document:t,features:l}=this._options,i=e?L:M;i(t,"mousedown",this._onTapStart),l.touch&&i(t,"touchstart",this._onTapStart,{passive:!1})}_delayedTapMove(e){let{behaviour:{startThreshold:t},document:l}=this._options,{x1:i,y1:n}=this._areaLocation,{x1:s,y1:o}=this._areaClientLocation,{x:r,y:c}=N(e);if("number"==typeof t&&P(r+c-(s+o))>=t||"object"==typeof t&&P(r-i)>=t.x||P(c-n)>=t.y){if(M(l,["mousemove","touchmove"],this._delayedTapMove,{passive:!1}),!1===this._emitEvent("beforedrag",e))return void M(l,["mouseup","touchcancel","touchend"],this._onTapStop);L(l,["mousemove","touchmove"],this._onTapMove,{passive:!1}),C(this._area,"display","block"),this._container.append(this._area),this.resolveSelectables(),this._singleClick=!1,L(this._container,"wheel",this._manualScroll,{passive:!0}),this._setupSelectionArea(),this._emitEvent("start",e),this._onTapMove(e)}this._handleMoveEvent(e)}_emitEvent(e,t){return this.emit(e,{event:t,selection:this,store:this._selection})}_handleMoveEvent(e){let{features:t}=this._options;(t.touch&&matchMedia("(hover: none), (pointer: coarse)").matches||this._scrollAvailable&&"safari"in window)&&e.preventDefault()}_keepSelection(){let{_options:e,_selection:t}=this,{changed:l,selected:i,stored:n,touched:s}=t,o=i.filter(e=>!n.includes(e));switch(e.behaviour.overlap){case"drop":t.stored=[...o,...n.filter(e=>!s.includes(e))];break;case"invert":t.stored=[...o,...n.filter(e=>!l.removed.includes(e))];break;case"keep":t.stored=[...n,...i.filter(e=>!n.includes(e))]}}_manualScroll(e){this.wheelTimer&&clearTimeout(this.wheelTimer);let{x:t,y:l}=N(e);this.wheelTimer=setTimeout(()=>{this._areaClientLocation.x2=t,this._areaClientLocation.y2=l;let e=l-this._containerRect.top,i=t-this._containerRect.left;this._areaLocation.x2=i+this._container.scrollLeft,this._areaLocation.y2=e+this._container.scrollTop,this._frame.next(null)},100)}_onScroll(e){let{document:t}=this._options;this.wheelTimer&&clearTimeout(this.wheelTimer);let{x:l,y:i}=N(e);this.wheelTimer=setTimeout(()=>{this._areaClientLocation.x2=l,this._areaClientLocation.y2=i;let e=i-this._containerRect.top+this._container.scrollTop+t.scrollingElement.scrollTop-this._initScrollDelta.y,n=l-this._containerRect.left+this._container.scrollLeft+t.scrollingElement.scrollLeft;this._scrollDelta.y=t.scrollingElement.scrollTop-this._initScrollDelta.y,this._scrollDelta.x=t.scrollingElement.scrollLeft-this._initScrollDelta.x,this._areaLocation.y2=e,this._areaLocation.x2=n,this._frame.next(null)},100)}_onSingleTap(e){let t,{range:l,singleTap:{intersect:i}}=this._options.features,n=N(e);if("native"===i)t=n.target;else if("touch"===i){this.resolveSelectables();let{x:e,y:l}=n;t=this._selectables.find(t=>{let{bottom:i,left:n,right:s,top:o}=t.getBoundingClientRect();return e<s&&e>n&&l<i&&l>o})}if(!t)return;for(this.resolveSelectables();!this._selectables.includes(t);){if(!t.parentElement)return;t=t.parentElement}let{stored:s}=this._selection;if(this._emitEvent("start",e),e.shiftKey&&l&&this._latestElement){let e=this._latestElement,[l,i]=4&e.compareDocumentPosition(t)?[t,e]:[e,t],n=[...this._selectables.filter(e=>4&e.compareDocumentPosition(l)&&2&e.compareDocumentPosition(i)),l,i];this.select(n),this._latestElement=e}else s.includes(t)&&(1===s.length||e.ctrlKey||s.every(e=>this._selection.stored.includes(e)))?this.deselect(t):(this.select(t),this._latestElement=t)}_onTapMove(e){let{x:t,y:l}=N(e),{_areaClientLocation:i,_areaLocation:n,_frame:s,_options:o,_scrollSpeed:r}=this,{speedDivider:c}=o.behaviour.scrolling,a=l-this._containerRect.top,d=t-this._containerRect.left;if(this._scrollAvailable&&!this._scrollingActive&&(r.y||r.x)){this._scrollingActive=!0;let t=()=>{if(!r.x&&!r.y){this._scrollingActive=!1;return}r.y&&(this._container.scrollTop+=B(r.y/c),n.y2=a),r.x&&(this._container.scrollLeft+=B(r.x/c),n.x2=d),s.next(e),requestAnimationFrame(t)};requestAnimationFrame(t)}else n.x2=d+this._container.scrollLeft+this._scrollDelta.x,n.y2=a+this._container.scrollTop+this._scrollDelta.y,i.x2=t,i.y2=l,s.next(e);this._handleMoveEvent(e)}_onTapStart(e){var t;let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{container:i,document:n}=this._options,{target:s,x:o,y:r}=N(e);if(this._container=F(i,n)[0],!this._container||this._container.contains(s)&&"true"!==s.dataset.slateEditor&&"true"!==s.dataset.plateSelectable)return;this._containerRect=this._container.getBoundingClientRect();let c=o-this._containerRect.left+this._container.scrollLeft,a=r-this._containerRect.top+this._container.scrollTop,{_options:d}=this;if(e instanceof MouseEvent&&!function(e,t){for(let l of t){if("number"==typeof l)return e.button===l;if("object"==typeof l){let t=l.button===e.button,i=l.modifiers.every(t=>{switch(t){case"alt":return e.altKey;case"ctrl":return e.ctrlKey||e.metaKey;case"shift":return e.shiftKey;default:return!1}});return t&&i}}return!1}(e,d.behaviour.triggers))return;let u=F(d.startAreas,d.document),h=F(d.boundaries,d.document),p=e.composedPath();if(!this._container||!u.find(e=>p.includes(e))||!h.find(e=>p.includes(e))||!l&&!1===this._emitEvent("beforestart",e))return;this._areaLocation={x1:c,x2:0,y1:a,y2:0},this._areaClientLocation={x1:o,x2:0,y1:r,y2:0};let f=null!=(t=n.scrollingElement)?t:n.body;this._initScrollDelta={x:f.scrollLeft,y:f.scrollTop},this._singleClick=!0,this.clearSelection(!1,!0),L(n,["touchmove","mousemove"],this._delayedTapMove,{passive:!1}),L(n,["mouseup","touchcancel","touchend"],this._onTapStop),L(n,"wheel",this._onScroll,{passive:!1})}_onTapStop(e,t){var l;let{document:i,features:n}=this._options,{_singleClick:s}=this;M(i,["mousemove","touchmove"],this._delayedTapMove),M(i,["touchmove","mousemove"],this._onTapMove),M(i,["mouseup","touchcancel","touchend"],this._onTapStop),M(i,"wheel",this._onScroll),this._keepSelection(),e&&s&&n.singleTap.allow?this._onSingleTap(e):s||t||(this._updateElementSelection(),this._emitEvent("stop",e)),this._scrollSpeed.x=0,this._scrollSpeed.y=0,this._scrollDelta.x=0,this._scrollDelta.y=0,M(this._container,"wheel",this._manualScroll,{passive:!0}),this._area.remove(),null==(l=this._frame)||l.cancel(),C(this._area,"display","none")}_recalculateSelectionAreaRect(){let{_areaClientLocation:e,_areaLocation:t,_areaRect:l,_container:i,_containerRect:n,_scrollSpeed:s}=this,{clientHeight:o,clientWidth:r,scrollHeight:c,scrollLeft:a,scrollTop:d,scrollWidth:u}=i,{x1:h,y1:p}=t,{x2:f,y2:m}=t,{behaviour:{scrolling:{startScrollMargins:v}}}=this._options;e.x2+this._scrollDelta.x<n.left+v.x?(s.x=a?-P(n.left-e.x2-this._scrollDelta.x):0,f=z(f,this._container.scrollLeft)):e.x2+this._scrollDelta.x>n.right-v.x?(s.x=u-a-r?P(n.left+this._container.clientWidth-e.x2-this._scrollDelta.x):0,f=r+a):s.x=0,e.y2+this._scrollDelta.y<n.top+v.y?(s.y=d?-P(n.top-e.y2-this._scrollDelta.y+v.y):0,m=z(m,this._container.scrollTop)):e.y2+this._scrollDelta.y>n.bottom-v.y?(s.y=c-d-o?P(e.y2+this._scrollDelta.y-(n.top+this._container.clientHeight-v.y)):0,m=o+d):s.y=0;let _=j(h,f),g=j(p,m),b=z(h,f),S=z(p,m);l.x=_,l.y=g,l.width=b-_,l.height=S-g}_redrawSelectionArea(){let{height:e,width:t,x:l,y:i}=this._areaRect,{style:n}=this._area;n.left="".concat(l,"px"),n.top="".concat(i,"px"),n.width="".concat(t,"px"),n.height="".concat(e,"px")}_setupSelectionArea(){}_updateElementSelection(){let{_areaRect:e,_options:t,_selectables:l,_selection:i}=this,{selected:n,stored:s,touched:o}=i,{intersect:r,overlap:c}=t.behaviour,a="invert"===c,d=[],u=[],h=[];for(let t=0;t<l.length;t++){let i=l[t];if(function(e,t,l,i){let n=i.getBoundingClientRect(),s=i.scrollLeft,o=i.scrollTop;return e.right>=t.left-n.left&&e.left+n.left<=t.right+s&&e.bottom-o>=t.top-n.top&&e.top<=t.bottom-n.top+o}(e,i.getBoundingClientRect(),0,this._container)){if(n.includes(i))s.includes(i)&&!o.includes(i)&&o.push(i);else{if(a&&s.includes(i)){h.push(i);continue}u.push(i)}d.push(i)}}a&&u.push(...s.filter(e=>!n.includes(e)));let p="keep"===c;for(let e=0;e<n.length;e++){let t=n[e];d.includes(t)||p&&s.includes(t)||h.push(t)}i.selected=d,i.changed={added:u,removed:h},this._latestElement=void 0}cancel(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._onTapStop(null,!e)}clearSelection(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{changed:l,selected:i,stored:n}=this._selection;l.added=[],l.removed.push(...i,...e?n:[]),t||(this._emitEvent("move",null),this._emitEvent("stop",null)),this._selection={changed:{added:[],removed:[]},selected:[],stored:e?[]:n,touched:[]}}deselect(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{changed:l,selected:i,stored:n}=this._selection,s=F(e,this._options.document).filter(e=>i.includes(e)||n.includes(e));0!==s.length&&(this._selection.stored=n.filter(e=>!s.includes(e)),this._selection.selected=i.filter(e=>!s.includes(e)),this._selection.changed.added=[],this._selection.changed.removed.push(...s.filter(e=>!l.removed.includes(e))),this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)))}destroy(){this.cancel(),this.disable(),super.unbindAllListeners()}getSelection(){return this._selection.stored}getSelectionArea(){return this._area}resolveSelectables(){this._selectables=F(this._options.selectables,this._options.document)}select(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{changed:l,selected:i,stored:n}=this._selection,s=F(e,this._options.document).filter(e=>!i.includes(e)&&!n.includes(e));return n.push(...s),i.push(...s),l.added.push(...s),l.removed=[],this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)),s}trigger(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this._onTapStart(e,t)}constructor(e){var t,l,s,o,r;for(const c of(super(),this._areaClientLocation={x1:0,x2:0,y1:0,y2:0},this._areaLocation={x1:0,x2:0,y1:0,y2:0},this._areaRect=new DOMRect,this._initScrollDelta={x:0,y:0},this._scrollAvailable=!0,this._scrollDelta={x:0,y:0},this._scrollingActive=!1,this._scrollSpeed={x:0,y:0},this._selectables=[],this._selection={changed:{added:[],removed:[]},selected:[],stored:[],touched:[]},this._singleClick=!0,this.wheelTimer=null,this.disable=this._bindStartEvents.bind(this,!1),this.enable=this._bindStartEvents,this._options=(0,n._)((0,i._)({boundaries:["html"],container:"body",document:window.document,selectables:[],selectionAreaClass:"selection-area",startAreas:["html"]},e),{behaviour:(0,n._)((0,i._)({intersect:"touch",overlap:"invert",triggers:[0]},e.behaviour),{scrolling:(0,n._)((0,i._)({manualSpeed:750,speedDivider:.7},null==(t=e.behaviour)?void 0:t.scrolling),{startScrollMargins:(0,i._)({x:20,y:40},null==(s=e.behaviour)||null==(l=s.scrolling)?void 0:l.startScrollMargins)}),startThreshold:(null==(o=e.behaviour)?void 0:o.startThreshold)?"number"==typeof e.behaviour.startThreshold?e.behaviour.startThreshold:(0,i._)({x:4,y:4},e.behaviour.startThreshold):{x:4,y:4}}),features:(0,n._)((0,i._)({range:!0,touch:!0},e.features),{singleTap:(0,i._)({allow:!0,intersect:"native"},null==(r=e.features)?void 0:r.singleTap)})}),Object.getOwnPropertyNames(Object.getPrototypeOf(this))))"function"==typeof this[c]&&(this[c]=this[c].bind(this));const{document:c,selectionAreaClass:a}=this._options;this._area=c.createElement("div"),this._area.classList.add(a),C(this._area,{left:0,position:"absolute",top:0,willChange:"top, left, bottom, right, width, height"}),this._frame=(e=>{let t,l=-1,i=!1;return{cancel(){cancelAnimationFrame(l),i=!1},next(){for(var n=arguments.length,s=Array(n),o=0;o<n;o++)s[o]=arguments[o];t=s,i||(i=!0,l=requestAnimationFrame(()=>{e(...t),i=!1}))}}})(e=>{this._recalculateSelectionAreaRect(),this._updateElementSelection(),this._emitEvent("move",e),this._redrawSelectionArea()}),this.enable()}};let q=e=>{let{selectedIds:t}=e.getOptions(et),l=e.getApi(et).blockSelection.getNodes({collapseTableRows:!0}),i=l.map(e=>{let[t]=e;return t});_(" ",{onCopy:n=>{if(!n)return;let s="",o=document.createElement("div");e.tf.withoutNormalizing(()=>{l.forEach(t=>{let[,l]=t;e.tf.select({anchor:e.api.start(l),focus:e.api.end(l)});let i=e.api.isEmpty(l);if(i){let t=e.api.after(e.selection);e.tf.select({anchor:e.api.start(l),focus:t})}i||e.tf.setFragmentData(n),i?s+="\n":s+="".concat(n.getData("text/plain"),"\n");let r=document.createElement("div");i?r.innerHTML="<p></p>":r.innerHTML=n.getData("text/html"),o.append(r)}),e.tf.deselect(),e.setOption(et,"selectedIds",t)}),n.setData("text/plain",s),n.setData("text/html",o.innerHTML);let r=JSON.stringify(i),c=window.btoa(encodeURIComponent(r));n.setData("application/x-slate-fragment",c)}})},H=e=>{let{setOption:t}=(0,a.Gt)(e,et),l=new Set;e.operations.forEach(t=>{"insert_node"===t.type&&t.node.id&&e.api.isBlock(t.node)&&l.add(t.node.id)}),t("selectedIds",l)},Q=(e,t)=>{let{api:l,setOption:i}=(0,h.nB)(e,et),n=l.blockSelection.getNodes();if(0!==n.length)if("up"===t){let[,t]=n[0],s=e.api.previous({at:t,from:"parent",match:l.blockSelection.isSelectable});if(s){let[e]=s;i("anchorId",e.id),l.blockSelection.set(e.id)}else l.blockSelection.set(n[0][0].id)}else{let[,t]=n.at(-1),s=e.api.next({at:t,from:"child",match:l.blockSelection.isSelectable});if(s){let[e]=s;i("anchorId",e.id),l.blockSelection.set(e.id)}else l.blockSelection.set(n.at(-1)[0].id)}},V=(e,t)=>{let{added:l,ids:i,removed:n}=t,{getOptions:s,setOption:c}=(0,a.Gt)(e,{key:r.t.blockSelection});if(i&&c("selectedIds",new Set(i)),l||n){let{selectedIds:e}=s(),t=new Set(e);if(l)for(let e of(0,o.a)(l))e&&t.add(e);if(n)for(let e of(0,o.a)(n))e&&t.delete(e);c("selectedIds",t)}c("isSelecting",!0)},W=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{api:i,getOptions:n,setOption:s}=(0,a.Gt)(e,{key:r.t.blockSelection}),{clear:c=!0,delay:d}=l,u=(0,o.r)(t);u&&(!n().selectedIds.has(t)&&c&&s("selectedIds",new Set),i.blockSelection.setSelectedIds({added:[u],removed:[]}),d&&setTimeout(()=>{i.blockSelection.setSelectedIds({added:[],removed:[u]})},d))},G=(e,t)=>{let{api:l,getOption:i,getOptions:n,setOption:s}=(0,h.nB)(e,et),o=l.blockSelection.getNodes();if(0===o.length)return;let[r,a]=o[0],[d,u]=o.at(-1),p=n().anchorId;p||s("anchorId",p="up"===t?d.id:r.id);let f=o.findIndex(e=>{let[t]=e;return t.id===p});if(-1===f)return void s("anchorId",d.id);let m=f===o.length-1,v=new Set(i("selectedIds"));if("down"===t)if(0===f){let t=e.api.next({at:u,mode:"highest",match:(e,t)=>l.blockSelection.isSelectable(e,t)&&!c.s2.isAncestor(t,u)});if(!t)return;let[i]=t;v.add(i.id)}else r.id&&r.id!==p&&v.delete(r.id);else if(m){let t=e.api.previous({at:a,from:"parent",match:l.blockSelection.isSelectable});if(!t)return;let[i,n]=t;c.s2.isAncestor(n,a)&&v.forEach(t=>{let l=e.api.node({id:t,at:n});l&&c.s2.isDescendant(l[1],n)&&(v.delete(t),t===p&&s("anchorId",p=i.id))}),v.add(i.id)}else d.id&&d.id!==p&&v.delete(d.id);v.add(p),s("selectedIds",v)},Z=e=>{let t=e.getApi(et).blockSelection.getNodes(),l=t.at(-1);if(!l)return;e.tf.duplicateNodes({nodes:t});let i=c.s2.next(l[1]),n=t.map((t,l)=>{var n;let s=[i[0]+l];return null==(n=e.api.node(s))?void 0:n[0].id}).filter(Boolean);setTimeout(()=>{e.setOption(et,"selectedIds",new Set(n))},0)},U=(e,t,l)=>{let{at:i,insertedCallback:n}=l;e.tf.insertNodes(t,{at:i}),null==n||n();let s=[c.lZ.get(e,i)],o=1;for(;o<t.length;){i=c.s2.next(i);let t=c.lZ.get(e,i);s.push(t),o++}setTimeout(()=>{e.setOption(et,"selectedIds",new Set(s.map(e=>e.id)))},0)},J=e=>{let t=e.getOption(et,"selectedIds");t&&e.tf.removeNodes({at:[],block:!0,match:e=>!!e.id&&t.has(e.id)})},X=e=>{e.tf.select(e.api.nodesRange(e.getApi(et).blockSelection.getNodes())),e.getApi(et).blockSelection.clear()},Y=(e,t,l)=>{e.tf.withoutNormalizing(()=>{e.getApi(et).blockSelection.getNodes().forEach(s=>{let[,o]=s;e.tf.setNodes(t,(0,n._)((0,i._)({},l),{at:o}))})})},$=(e,t,l)=>{let s=e.getApi(et);e.tf.withoutNormalizing(()=>{s.blockSelection.getNodes().forEach(s=>{var o;let[r,c]=s,a=(null!=(o=r.indent)?o:0)+t;e.tf.setNodes({indent:Math.max(a,0)},(0,n._)((0,i._)({},l),{at:c}))})})},ee=(e,t,l)=>{Y(e,t,(0,i._)({mode:"lowest"},l))},et=(0,h.e3)({key:r.t.blockSelection,editOnly:!0,handlers:{onMouseDown:e=>{let{api:t,editor:l,event:i,getOptions:n}=e,s=i.target;s.dataset.platePreventUnselect||s.dataset.platePreventDeselect||0===i.button&&n().selectedIds.size>0&&!l.getOption(b,"openId")&&t.blockSelection.deselect()}},inject:{isBlock:!0,nodeProps:{transformProps:()=>(()=>{let e,t,l=(0,s.c)(6),i=(0,v.c)(6),n=(0,h.iQ)(),o=(0,h.lT)();if(i[0]===Symbol.for("react.memo_cache_sentinel")){let t;l[0]===Symbol.for("react.memo_cache_sentinel")?(t={key:r.t.blockSelection},l[0]=t):t=l[0],e=t,i[0]=e}else e=i[0];let{api:c,editor:a}=(0,h.CF)(e);if(i[1]!==c.blockSelection||i[2]!==a||i[3]!==n||i[4]!==o){let e;if(l[1]!==c.blockSelection||l[2]!==a||l[3]!==n||l[4]!==o){var d;e={props:(null==(d=c.blockSelection)?void 0:d.isSelectable(n,o))?{className:"slate-selectable",onContextMenu:e=>y(a,{element:n,event:e})}:{}},l[1]=c.blockSelection,l[2]=a,l[3]=n,l[4]=o,l[5]=e}else e=l[5];t=e,i[1]=c.blockSelection,i[2]=a,i[3]=n,i[4]=o,i[5]=t}else t=i[5];return t})().props}},options:{anchorId:null,areaOptions:{features:{singleTap:{allow:!1}}},enableContextMenu:!1,disableSelectAll:!1,isSelecting:!1,isSelectionAreaVisible:!1,selectedIds:new Set,shadowInputRef:{current:null},isSelectable:()=>!0},plugins:[b],render:{afterEditable:()=>{let e=(0,h.Q_)(),{api:t,getOption:l,getOptions:n,setOption:u}=(0,h.CF)({key:r.t.blockSelection}),p=(0,h.gO)(et,"isSelectingSome"),v=(0,h.gO)(et,"selectedIds"),_=f.useCallback(function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=[...e.api.nodes({at:[],match:e=>!!e.id&&(null==v?void 0:v.has(e.id))})];if(0===i.length)return null;let n=i[0][1];return e.tf.withoutNormalizing(()=>{for(let[l,n]of[...i].reverse())e.tf.removeNodes({at:n}),t.blockSelection.delete(l.id);if(0===e.children.length)e.meta._forceFocus=!0,e.tf.focus(),e.meta._forceFocus=!1;else if(l.selectPrevious){let t=c.s2.previous(n);if(t){let l=e.api.block({at:t});l&&u("selectedIds",new Set([l[0].id]))}}}),n},[e,t.blockSelection,v,u]);(()=>{let e,t,l,n,c,a,d=(0,s.c)(16),{api:u,editor:p,getOption:m,getOptions:v,setOption:_}=(0,h.CF)(et);d[0]!==v?(e=v(),d[0]=v,d[1]=e):e=d[1];let{areaOptions:g}=e;d[2]===Symbol.for("react.memo_cache_sentinel")?(t={ids:new Set},d[2]=t):t=d[2];let b=f.useRef(t);d[3]===Symbol.for("react.memo_cache_sentinel")?(l={ids:new Set},d[3]=l):l=d[3];let S=f.useRef(l);d[4]!==p||d[5]!==_?(n=()=>{p.api.isFocused()&&p.tf.blur(),p.selection&&p.tf.deselect(),_("isSelectionAreaVisible",!0)},d[4]=p,d[5]=_,d[6]=n):n=d[6];let y=n;d[7]!==u||d[8]!==g||d[9]!==p||d[10]!==m||d[11]!==v||d[12]!==y||d[13]!==_?(c=()=>{let e=new K((0,i._)({boundaries:"#".concat(p.meta.uid),container:"#".concat(p.meta.uid),document:window.document,selectables:"#".concat(p.meta.uid," .slate-selectable"),selectionAreaClass:"slate-selection-area"},g)).on("beforestart",()=>{_("isSelecting",!1)}).on("start",t=>{let{event:l}=t;y(),(null==l?void 0:l.shiftKey)||(e.clearSelection(),u.blockSelection.clear())}).on("move",e=>{let t,l,i,{store:n}=e,{changed:s}=n;v().isSelectionAreaVisible||y(),(()=>{if(0===s.added.length&&0===s.removed.length)return;let e=new Set(v().selectedIds);(0,o.a)(s.removed).forEach(t=>{e.delete(t),b.current.ids.delete(t)}),new Set((0,o.a)(s.added)).forEach(t=>{let l=p.api.block({at:[],match:e=>!!e.id&&e.id===t});if(l&&l[0].type!==r.t.table){if(1===l[1].length){e.add(t),b.current.ids.add(t);return}p.api.block({above:!0,at:l[1],match:e=>!!e.id&&b.current.ids.has(e.id)})||(e.add(t),b.current.ids.add(t))}}),_("selectedIds",e)})(),l=Array.from(t=new Set(m("selectedIds"))),i=e=>p.api.block({at:[],match:t=>!!t.id&&t.id===e}),l.every(e=>{let t=i(e);return!!t&&(t[1].length>=3||function(e){return e.type===r.t.table||e.type===r.t.tr||e.type===r.t.th}(t[0]))})?l.some(e=>{let l=i(e);return!!l&&l[0].type===r.t.table&&(t.delete(e),S.current.ids.forEach(e=>{t.add(e)}),S.current.ids.clear(),!0)}):l.some(e=>{let l=i(e);if(!l||!function(e){return e.type===r.t.tr||e.type===r.t.th}(l[0]))return!1;let n=p.api.block({above:!0,at:l[1]});if(!n)return!1;let s=n[0].children.map(ei);return t.add(n[0].id),s.forEach(e=>{t.has(e)&&(S.current.ids.add(e),t.delete(e))}),!0}),_("selectedIds",t)}).on("stop",()=>{b.current={ids:new Set},S.current={ids:new Set},_("isSelectionAreaVisible",!1)});return()=>e.destroy()},d[7]=u,d[8]=g,d[9]=p,d[10]=m,d[11]=v,d[12]=y,d[13]=_,d[14]=c):c=d[14],d[15]===Symbol.for("react.memo_cache_sentinel")?(a=[],d[15]=a):a=d[15],f.useEffect(c,a)})();let g=f.useRef(null),[b,S]=f.useState(!1);f.useEffect(()=>(S(!0),u("shadowInputRef",g),()=>{S(!1)}),[u]),f.useEffect(()=>{p||u("anchorId",null)},[p,u]),f.useEffect(()=>{p&&g.current?g.current.focus({preventScroll:!0}):g.current&&g.current.blur()},[p]);let y=f.useCallback(i=>{var s,o;let r=e.api.isReadOnly();if(null==(s=(o=n()).onKeyDownSelecting)||s.call(o,e,i.nativeEvent),l("isSelectingSome")){if((0,d.v_)("shift+up")(i)){i.preventDefault(),i.stopPropagation(),t.blockSelection.shiftSelection("up");return}if((0,d.v_)("shift+down")(i)){i.preventDefault(),i.stopPropagation(),t.blockSelection.shiftSelection("down");return}if((0,d.v_)("escape")(i))return void t.blockSelection.deselect();if((0,d.v_)("mod+z")(i)){e.undo(),H(e);return}if((0,d.v_)("mod+a")(i))return void t.blockSelection.selectAll();if((0,d.v_)("mod+shift+z")(i)){e.redo(),H(e);return}if((0,d.v_)("mod+d")(i)){i.preventDefault(),e.getTransforms(et).blockSelection.duplicate();return}if(l("isSelectingSome")){if((0,d.v_)("enter")(i)){let t=e.api.node({at:[],block:!0,match:e=>!!e.id&&(null==v?void 0:v.has(e.id))});if(t){let[,l]=t;e.meta._forceFocus=!0,e.tf.focus({at:l,edge:"end"}),e.meta._forceFocus=void 0,i.preventDefault()}return}if((0,d.v_)(["backspace","delete"])(i)&&!r){i.preventDefault(),_({selectPrevious:(0,d.v_)("backspace")(i)});return}if((0,d.v_)("up")(i)){i.preventDefault(),i.stopPropagation(),t.blockSelection.moveSelection("up");return}if((0,d.v_)("down")(i)){i.preventDefault(),i.stopPropagation(),t.blockSelection.moveSelection("down");return}if(!r&&1===i.key.length&&!i.ctrlKey&&!i.metaKey&&!i.altKey){i.preventDefault();let t=_();t&&(e.meta._forceFocus=!0,e.tf.insertNodes(e.api.create.block({children:[{text:i.key}]}),{at:t}),e.tf.select(t,{edge:"end"}),e.meta._forceFocus=!1,e.tf.focus());return}}}},[e,n,l,t.blockSelection,_,v]),k=f.useCallback(t=>{t.preventDefault(),l("isSelectingSome")&&q(e)},[e,l]),w=f.useCallback(t=>{t.preventDefault(),l("isSelectingSome")&&(q(e),e.api.isReadOnly()||_())},[e,l,_]),x=f.useCallback(t=>{t.preventDefault(),e.api.isReadOnly()||((e,t)=>{let{api:l}=(0,a.Gt)(e,et),i=l.blockSelection.getNodes();if(i.length>0){let[l,n]=i.at(-1);if(!e.api.isEmpty(l)){let t=c.s2.next(n);e.tf.insertNodes(e.api.create.block({},t),{at:t,select:!0})}e.tf.insertData(t.clipboardData),H(e)}})(e,t.nativeEvent)},[e]);return b?m.createPortal(f.createElement("input",{ref:g,className:"slate-shadow-input",style:{left:"-300px",opacity:0,position:"fixed",top:"-300px",zIndex:999},onCopy:k,onCut:w,onKeyDown:y,onPaste:x}),document.body):null}}}).extendSelectors(e=>{let{getOptions:t}=e;return{isSelected:e=>!!e&&t().selectedIds.has(e),isSelectingSome:()=>t().selectedIds.size>0}}).extendApi(e=>{let{editor:t,getOption:l,getOptions:s,setOption:o}=e;return{addOnContextMenu:(0,u.gv)(y,t),moveSelection:(0,u.gv)(Q,t),setSelectedIds:(0,u.gv)(V,t),shiftSelection:(0,u.gv)(G,t),add:e=>{let t=new Set(s().selectedIds);if(Array.isArray(e))for(let l of e)t.add(l);else t.add(e);o("selectedIds",t)},clear:()=>{o("selectedIds",new Set)},delete:e=>{let t=new Set(s().selectedIds);if(Array.isArray(e))for(let l of e)t.delete(l);else t.delete(e);o("selectedIds",t)},deselect:()=>{o("selectedIds",new Set),o("isSelecting",!1)},first:()=>{let e=l("selectedIds");return e&&0!==e.size?t.api.node({at:[],match:t=>e.has(t.id)}):null},focus:()=>{let e=l("shadowInputRef");(null==e?void 0:e.current)&&e.current.focus({preventScroll:!0})},getNodes:e=>{let s=l("selectedIds"),o=t.api.blocks({at:[],match:e=>!!e.id&&(null==s?void 0:s.has(e.id))});if((null==e?void 0:e.sort)&&o.sort((e,t)=>{let[,l]=e,[,i]=t;return c.s2.compare(l,i)}),null==e?void 0:e.collapseTableRows){let e=[];return o.forEach(l=>{let[s,o]=l;if(s.type===r.t.tr){let l=c.s2.parent(o),r=t.api.node(l),a=e.findIndex(e=>{let[t]=e;return t.type===r[0].type&&t.id===r[0].id});if(-1===a){let t=(0,n._)((0,i._)({},r[0]),{children:[s]});e.push([t,r[1]])}else e[a][0].children.push(s);return}e.push([s,o])}),e}return 0===o.length&&(null==e?void 0:e.selectionFallback)?t.api.blocks({mode:"highest"}):o},has:e=>Array.isArray(e)?e.every(e=>s().selectedIds.has(e)):s().selectedIds.has(e),isSelectable:(e,l)=>!!e.id&&t.api.isBlock(e)&&s().isSelectable(e,l),resetSelectedIds:()=>{o("selectedIds",new Set)},set:e=>{o("selectedIds",new Set(Array.isArray(e)?e:[e]))},unselect:()=>{o("selectedIds",new Set),o("isSelecting",!1)}}}).extendApi(e=>{let{api:t,editor:l,setOption:i}=e;return{addSelectedRow:(0,u.gv)(W,l),selectAll:()=>{i("selectedIds",new Set(t.blocks({at:[],mode:"highest",match:(e,l)=>!!e.id&&t.blockSelection.isSelectable(e,l)}).map(e=>e[0].id))),t.blockSelection.focus()}}}).extendTransforms(e=>{let{editor:t}=e;return{duplicate:(0,u.gv)(Z,t),insertBlocksAndSelect:(0,u.gv)(U,t),removeNodes:(0,u.gv)(J,t),select:(0,u.gv)(X,t),selectBlocks:(0,u.gv)(S,t),setIndent:(0,u.gv)($,t),setNodes:(0,u.gv)(Y,t),setTexts:(0,u.gv)(ee,t)}}).overrideEditor(e=>{let{api:t,api:{nodes:l},editor:i,getOption:n,getOptions:s,tf:{addMark:o,escape:r,focus:c,selectAll:a,setNodes:d,setSelection:u,toggleMark:h}}=e;return{api:{nodes:e=>!(null==e?void 0:e.at)&&n("isSelectingSome")?t.blockSelection.getNodes():l(e)},transforms:{addMark(t,l){el(e,()=>{o(t,l)})},escape:()=>!!(()=>{let e=i.api.block({highest:!0});if(!e)return;let l=e[0].id;if(l)return t.blockSelection.set(l),!0})()||r(),focus(){!i.meta._forceFocus&&n("isSelectingSome")||c()},selectAll:()=>s().disableSelectAll?a():!!(()=>{let e=i.api.block({highest:!0});if(!e)return;let[,l]=e;return i.api.isAt({block:!0,end:!0,start:!0})||!i.api.isAt({block:!0})?t.blockSelection.selectAll():i.tf.select(l),!0})()||a(),setNodes(t,l){el(e,()=>{d(t,l)})},setSelection(e){s().selectedIds.size>0&&!i.getOption(b,"openId")&&t.blockSelection.deselect(),u(e)},toggleMark(t,l){el(e,()=>{h(t,l)})}}}}),el=(e,t)=>{let{api:l,editor:i,getOption:n}=e;n("isSelectingSome")?i.tf.withoutNormalizing(()=>{let e=i.getApi(et).blockSelection.getNodes();i.tf.select(i.api.nodesRange(e)),t(),l.blockSelection.set(e.map(e=>{let[t]=e;return t.id}))}):t()};function ei(e){return e.id}},87010:(e,t,l)=>{l.d(t,{a:()=>n,r:()=>s,t:()=>o});var i=l(48674);let n=e=>e.map(e=>e.dataset.blockId).filter(Boolean),s=e=>document.querySelector('.slate-selectable[data-block-id="'.concat(e,'"]')),o=e=>{let t=e.getOption({key:i.t.blockSelection},"isSelectingSome");return e.api.isExpanded()||t}}}]);