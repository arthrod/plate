"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64105],{64105:(e,r,t)=>{t.d(r,{g:()=>U});var n=t(99019),a=t(5147);t(54568);var o=t(7620),l=t(91898),s=t(72698),i=t(94025);let u=()=>{let e,r,t=new AbortController;return{promise:new Promise((t,n)=>{e=t,r=n}),ac:t,resolve:e,reject:r}};var d=t(97339),p=t(40064),c=t(13043);let f=e=>(r,t)=>i.Jk(function*(){var n;let a,o,s=((o=new URLSearchParams((a=new URL((n={url:e.url,slug:e.endpoint,actionType:r}).url)).search)).set("actionType",n.actionType),o.set("slug",n.slug),a.search=o.toString(),a),u=new Headers((yield*i.iv(async()=>"function"==typeof e.headers?await e.headers():e.headers)));return e.package&&u.set("x-uploadthing-package",e.package),u.set("x-uploadthing-version","7.7.2"),u.set("Content-Type","application/json"),yield*(0,l.os)(s,{method:"POST",body:JSON.stringify(t),headers:u}).pipe(i.hg(l.de),i.Tj(d.Mi),i.Ku("FetchError",e=>i.fJ(new l.SD({code:"INTERNAL_CLIENT_ERROR",message:`Failed to report event "${r}" to UploadThing server`,cause:e}))),i.Ku("BadRequestError",e=>i.fJ(new l.SD({code:(0,l.Ci)(e.status),message:e.getMessage(),cause:e.json}))),i.Ku("InvalidJson",e=>i.fJ(new l.SD({code:"INTERNAL_CLIENT_ERROR",message:"Failed to parse response from UploadThing server",cause:e}))))}),g=(e,r,t)=>(0,l.os)(r.url,{method:"HEAD"}).pipe(i.Tj(({headers:e})=>parseInt(e.get("x-ut-range-start")??"0",10)),i.Mi(e=>t.onUploadProgress?.({delta:e,loaded:e})),i.qI(n=>{let a;return a=e=>t.onUploadProgress?.({delta:e.delta,loaded:e.loaded+n}),i.bI(t=>{let o=new XMLHttpRequest;o.open("PUT",r.url,!0),o.setRequestHeader("Range",`bytes=${n}-`),o.setRequestHeader("x-uploadthing-version","7.7.2"),o.responseType="json";let s=0;o.upload.addEventListener("progress",({loaded:e})=>{let r=e-s;a?.({loaded:e,delta:r}),s=e}),o.addEventListener("load",()=>{o.status>=200&&o.status<300&&(0,p.u4)(o.response)?(0,p.i5)(o.response,"error")?t(new l.SD({code:"UPLOAD_FAILED",message:String(o.response.error),data:o.response})):t(i.Py(o.response)):t(new l.SD({code:"UPLOAD_FAILED",message:`XHR failed ${o.status} ${o.statusText}`,data:o.response}))}),o.addEventListener("error",()=>{t(new l.SD({code:"UPLOAD_FAILED"}))});let u=new FormData;return"uri"in e?u.append("file",{uri:e.uri,type:e.type,name:e.name,...n>0&&{range:n}}):u.append("file",n>0?e.slice(n):e),o.send(u),i.OH(()=>o.abort())})}),i.Tj(d.Mi),i.Tj(t=>({name:e.name,size:e.size,key:r.key,lastModified:e.lastModified,serverData:t.serverData,get url(){return(0,c.t)("`file.url` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),t.url},get appUrl(){return(0,c.t)("`file.appUrl` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),t.appUrl},ufsUrl:t.ufsUrl,customId:r.customId,type:e.type,fileHash:t.fileHash}))),h=e=>{let r=(0,l.Lt)();return{uploadFiles:(t,n)=>{var a;let o,s,u,d="function"==typeof t?t(r):t,p=e?.fetch??window.fetch;return(a={...n,skipPolling:{},url:(0,l.s2)(e?.url),package:e?.package??"uploadthing/client",input:n.input},o=f({endpoint:String(d),package:a.package,url:a.url,headers:a.headers}),s=a.files.reduce((e,r)=>e+r.size,0),u=0,i.qI(o("upload",{input:"input"in a?a.input:null,files:a.files.map(e=>({name:e.name,size:e.size,type:e.type,lastModified:e.lastModified}))}),e=>i.jJ(e,(e,r)=>i.qI(i.OH(()=>a.onUploadBegin?.({file:a.files[r].name})),()=>g(a.files[r],e,{onUploadProgress:e=>{u+=e.delta,a.onUploadProgress?.({file:a.files[r],progress:e.loaded/a.files[r].size*100,loaded:e.loaded,delta:e.delta,totalLoaded:u,totalProgress:u/s})}})),{concurrency:6}))).pipe(i.Pf(l.MC,p),e=>i.Np(e,n.signal&&{signal:n.signal})).then(e=>{if("Success"===e._tag)return e.value;if("Interrupt"===e.cause._tag)throw new l.tZ;throw i.Re(e.cause)})},createUpload:async(t,n)=>{let a=new Map,o=f({endpoint:String("function"==typeof t?t(r):t),package:e?.package??"uploadthing/client",url:(0,l.s2)(e?.url),headers:n.headers}),d=e?.fetch??window.fetch,p=await i.pR(o("upload",{input:"input"in n?n.input:null,files:n.files.map(e=>({name:e.name,size:e.size,type:e.type,lastModified:e.lastModified}))}).pipe(i.Pf(l.MC,d))),c=n.files.reduce((e,r)=>e+r.size,0),h=0,w=(e,r)=>g(e,r,{onUploadProgress:r=>{h+=r.delta,n.onUploadProgress?.({...r,file:e,progress:Math.round(r.loaded/e.size*100),totalLoaded:h,totalProgress:Math.round(h/c*100)})}}).pipe(i.Pf(l.MC,d));for(let[e,r]of p.entries()){let t=n.files[e];if(!t)continue;let o=u();a.set(t,{deferred:o,presigned:r}),i.Np(w(t,r),{signal:o.ac.signal}).then(e=>{if("Success"===e._tag)return o.resolve(e.value);if("Interrupt"===e.cause._tag)throw new l.oZ;throw i.Re(e.cause)}).catch(e=>{e instanceof l.oZ||o.reject(e)})}return{pauseUpload:e=>{for(let r of s.D8(e??n.files)){let e=a.get(r);if(!e)return;if(e.deferred.ac.signal.aborted)throw new l.tZ;e.deferred.ac.abort()}},resumeUpload:e=>{for(let r of s.D8(e??n.files)){let e=a.get(r);if(!e)throw"No upload found";e.deferred.ac=new AbortController,i.Np(w(r,e.presigned),{signal:e.deferred.ac.signal}).then(r=>{if("Success"===r._tag)return e.deferred.resolve(r.value);if("Interrupt"===r.cause._tag)throw new l.oZ;throw i.Re(r.cause)}).catch(r=>{r instanceof l.oZ||e.deferred.reject(r)})}},done:async e=>{let r=[];for(let t of s.D8(e??n.files)){let e=a.get(t);if(!e)throw"No upload found";r.push(e.deferred.promise)}let t=await Promise.all(r);return e?t[0]:t}}},routeRegistry:r}},w="u">typeof window?o.useInsertionEffect:()=>void 0;function v(){throw Error("INVALID_USEEVENT_INVOCATION: the callback from useEvent cannot be invoked before the component has mounted.")}let y=function(e,r,t,s){var i,u;let d,p,c=null!=(i=null==s?void 0:s.uploadProgressGranularity)?i:"coarse",{uploadFiles:f,routeRegistry:g}=h({fetch:t,url:e,package:"@uploadthing/react"}),[y,U]=(0,o.useState)(!1),m=(0,o.useRef)(0),E=(0,o.useRef)(new Map);return{startUpload:(u=async function(){for(var e,t,n,a,o,i=arguments.length,u=Array(i),d=0;d<i;d++)u[d]=arguments[d];let p=null!=(e=await (null==s||null==(t=s.onBeforeUploadBegin)?void 0:t.call(s,u[0])))?e:u[0],g=u[1];U(!0),p.forEach(e=>E.current.set(e,0)),null==s||null==(n=s.onUploadProgress)||n.call(s,0);try{let e=await f(r,{signal:null==s?void 0:s.signal,headers:null==s?void 0:s.headers,files:p,onUploadProgress:e=>{if(!(null==s?void 0:s.onUploadProgress))return;E.current.set(e.file,e.progress);let r=0;E.current.forEach(e=>{r+=e});let t=(0,l.qs)(Math.min(100,r/E.current.size),c);t!==m.current&&(s.onUploadProgress(t),m.current=t)},onUploadBegin(e){let{file:r}=e;(null==s?void 0:s.onUploadBegin)&&s.onUploadBegin(r)},input:g});return await (null==s||null==(a=s.onClientUploadComplete)?void 0:a.call(s,e)),e}catch(r){let e;if(r instanceof l.tZ)throw r;r instanceof l.SD?e=r:console.error("Something went wrong. Please contact UploadThing and provide the following cause:",(e=(0,l.fN)(r)).cause instanceof Error?e.cause.toString():e.cause),await (null==s||null==(o=s.onUploadError)?void 0:o.call(s,e))}finally{U(!1),E.current=new Map,m.current=0}},d=o.useRef(v),w(()=>{d.current=u},[u]),null!=(p=o.useRef(null)).current||(p.current=function(){return d.current.apply(this,arguments)}),p.current),isUploading:y,routeConfig:((e,r,t)=>{var s,i;let u=globalThis.__UPLOADTHING,{data:d}=function(e,r,t){let s=(0,o.useRef)({}),i=(0,o.useRef)(!1),u={error:void 0,data:void 0},[d,p]=(0,o.useReducer)((e,r)=>{switch(r.type){case"loading":return(0,n._)({},u);case"fetched":return(0,a._)((0,n._)({},u),{data:r.payload});case"error":return(0,a._)((0,n._)({},u),{error:r.payload});default:return e}},u);return(0,o.useEffect)(()=>{if(r)return i.current=!1,(async()=>{if(p({type:"loading"}),s.current[r])return p({type:"fetched",payload:s.current[r]});try{let t=await e(r,void 0);if(!t.ok)throw Error(t.statusText);let n=await (0,l.N8)(t);if(n instanceof Error)throw n;if(s.current[r]=n,i.current)return;p({type:"fetched",payload:n})}catch(e){if(i.current)return;p({type:"error",payload:e})}})(),()=>{i.current=!0}},[r]),d}(e,u?void 0:r.href);return null==(i=null!=u?u:d)||null==(s=i.find(e=>e.slug===t))?void 0:s.config})(t,e,(0,l.oA)(r,g))}},U=e=>{var r;(0,l.GI)("@uploadthing/react","^7.2.0","7.7.2");let t=null!=(r=null==e?void 0:e.fetch)?r:globalThis.fetch,o=(0,l.s2)(null==e?void 0:e.url),s=h({fetch:t,url:o,package:"@uploadthing/react"});return(0,a._)((0,n._)({useUploadThing:function(e,r){return y(o,e,t,r)}},s),{getRouteConfig:function(e){var r;let t=globalThis.__UPLOADTHING,n=(0,l.oA)(e,s.routeRegistry),a=null==t||null==(r=t.find(e=>e.slug===n))?void 0:r.config;if(!a)throw Error('No config found for endpoint "'.concat(n.toString(),'". Please make sure to use the NextSSRPlugin in your Next.js app.'));return a}})}}}]);